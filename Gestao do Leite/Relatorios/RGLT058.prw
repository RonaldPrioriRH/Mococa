#INCLUDE "PROTHEUS.CH"
#INCLUDE "REPORT.CH"
#INCLUDE "TOPCONN.CH"
/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³RGLT058     º Autor ³ TOTVS                 º Data da Criacao  ³ 26/12/2017            						º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDescricao ³ Totalização do faturamento - Gera informação de todas as filiais consolidadas.          						º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ Gestao do Leite                                                   											º±±
±±º          ³ 	 							                                                                                º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºParametros³                                                                                        						º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºRetorno   ³ Nenhum					                                                                                  	º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUsuario   ³															                             						º±±
±±ÌÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºSetor     ³ Gestao do Leite	                                                                       						º±±
±±ÌÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±º            						ATUALIZACOES SOFRIDAS DESDE A CONSTRU€AO INICIAL                   						º±±
±±ÌÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºAutor     ³ Data     ³ Motivo da Alteracao  				               ³Usuario(Filial+Matricula+Nome)    ³Setor        º±±
±±ÌÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄ¹±±
±±º          ³          ³                    							   ³                                  ³ 			º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
User Function RGLT058

Local nQtdReg:=0

Private oCB
Private oReport
Private cPerg    := PADR("RGLT058",10)
//Private aOrd     := {"Nome","Codigo+Loja"}

ValidPerg()
If !Pergunte(cPerg,.T.)
	Return
EndIf

DEFINE REPORT oReport NAME 'RGLT058' TITLE "Totalização do Faturamento "+MV_PAR02+"/"+MV_PAR01 PARAMETER cPerg ACTION {|oReport| runRel(oReport)}

oReport:SetPortrait()// ou SetPortrait() - SetLandscape()
//oReport:HideHeader() // Nao imprime cabecalho padrao do Protheus
//oReport:HideFooter() // Nao imprime rodape padrao do Protheus
oReport:SetTotalInLine(.F.)
oReport:lParamPage	:= .F.

DEFINE SECTION OCB OF oReport TITLE "TOTFAT" //ORDERS aOrd

oReport:PrintDialog()

Return


/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³ RunRel   º Autor ³ Microsiga          º Data ³  00/00/00   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³                                                            º±±
±±º          ³                                                            º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³                                                            º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Static Function RunRel()

Local xArea
Local nTamMax		:= oReport:PageWidth()- 50 //Tamanho máximo da página
Local nTamMid		:= (oReport:PageWidth()/3) //um terço da pagina

Local nTab01  := 150
Local nTab02  := 1100
Local nTab03  := 1500
Local nTab04  := 1600
Local nTab05  := 2050

Local _nPos1 := 100
Local _nPos2 := 350
Local _nPos3 := 1400
Local _nPos4 := 1800
Local _nPos5 := 700
Local _nPos6 := 1200

Local nReg    := 0
Local _cCodFil := ""
Local _aTotais := {0,0,0,0,0}//litragem,proventos,descontos,inss,qtd.produtores,
Local _nTotCre := 0
Local _nTotDeb := 0
Local _nLeite := 0
Local _nInss := 0
Local _nVlrINSS := 0
Local _nVlrEvento	:= 0

Private nL    := 0
Private _dDtIni := CTOD("01/"+MV_PAR02+"/"+MV_PAR01)
Private _dDtFim := LastDay(_dDtIni)
Private _cAlias01 := GetNextAlias()
Private _cAlias02 := GetNextAlias()
Private _lAberto := .f. //Indica se o período está aberto
Private _cEveInss := AllTrim(GETMV("LT_EVEINSS"))
Private _cEvetAdc := AllTrim(GetMv("LT_EVEADIC")) //Codigo do Evento de Adicional de Mercado

             
//Verifica se existem MIX em aberto no período filtrado                
DbSelectArea("ZLE")
ZLE->(DbGoTop())
While !ZLE->(Eof())                
	If ZLE->ZLE_DTINI >= _dDtIni .AND. ZLE->ZLE_DTFIM <= _dDtFim 
		If ZLE->ZLE_STATUS == 'A'
			_lAberto := .t.
			Exit
		EndIf
	EndIf
	ZLE->(DbSkip())
EndDo

oFontTitulo:=TFont():New("Arial",09,14,.T.,.T.,5,.T.,5,.T.,.F.)
oFontRotulo:=TFont():New("Arial",09,11,.T.,.T.,5,.T.,5,.T.,.F.)
oFontNormal:=TFont():New("Arial",09,11,.F.,.F.,5,.T.,5,.T.,.F.)
oFontDetCv1:=TFont():New("Courier New",09,11,.F.,.F.,5,.T.,5,.T.,.F.)
oFontDetCv2:=TFont():New("Courier New",09,11,.T.,.T.,5,.T.,5,.T.,.F.)

// Obtem dados de impressao
CriaTab(_cAlias01,1)

dbSelectArea(_cAlias01)
Count To nQtdReg


oReport:Section(1):Init()
oReport:SetMeter(nQtdReg)

nL     := 250

(_cAlias01)->(dbgotop())
While !(_cAlias01)->(Eof()) .And. !oReport:Cancel()
	
	If nL >= oReport:PageHeight() - 200
		oReport:EndPage()
		oReport:StartPage()
		nL     := 250
	EndIf
	oReport:IncMeter()

	_cCodFil := (_cAlias01)->CODFIL
	_cCodMix := (_cAlias01)->MIX	
	_nLeite := (_cAlias01)->QTD
	_aTotais[1] += (_cAlias01)->QTD
	
	oReport:Box(nL-10	,oReport:PageWidth() * 0.01,nL + 60,nTamMax)
	oReport:Say(nL,nTamMid,"UNIDADE:   "+Alltrim(FWFilialName(cEmpAnt,_cCodFil)),oFontRotulo)	
	oReport:Say(nL,_nPos4-50,"Volume: "+Transform(_nLeite,"@E 999,999,999,999")+" litros",oFontRotulo)
	//oReport:FillRect({nL,2300,nL+1,100},TBrush():New("",0))
	nL +=80
	oReport:Say(nL,_nPos1,"CÓDIGO:",oFontRotulo)
	oReport:Say(nL,_nPos2,"DESCRIÇÃO EVENTO ",oFontRotulo)
	oReport:Say(nL,_nPos3,"PROVENTOS",oFontRotulo)
	oReport:Say(nL,_nPos4,"DESCONTOS",oFontRotulo)
	nL += 50
	oReport:FillRect({nL,2300,nL+1,100},TBrush():New("",0))	
	nL += 50
	_nVlrINSS := 0

	While !(_cAlias01)->(Eof()) .And. !oReport:Cancel() .And. (_cCodFil == (_cAlias01)->CODFIL)

		If nL >= oReport:PageHeight() - 200
			oReport:EndPage()
			oReport:StartPage()
			nL     := 250
			oReport:Say(nL,_nPos1,"CÓDIGO:",oFontRotulo)
			oReport:Say(nL,_nPos2,"DESCRIÇÃO EVENTO ",oFontRotulo)
			oReport:Say(nL,_nPos3,"PROVENTOS",oFontRotulo)
			oReport:Say(nL,_nPos4,"DESCONTOS",oFontRotulo)
			nL += 50
			oReport:FillRect({nL,2300,nL+1,100},TBrush():New("",0))	
			nL += 50
		EndIf

		_nVlrEvento := 0
		If (_cAlias01)->EVENTO == _cEvetAdc
			_nVlrEvento := _nVlrINSS + (_cAlias01)->VALOR
		Else
			_nVlrEvento:= (_cAlias01)->VALOR
		EndIf

		If (_cAlias01)->EVENTO == _cEveInss 
			_nVlrINSS := (_cAlias01)->VALOR
			
			(_cAlias01)->(DbSkip())
			Loop
		EndIf


		oReport:Say(nL,_nPos1,(_cAlias01)->EVENTO,oFontNormal)
		oReport:Say(nL,_nPos2,Alltrim((_cAlias01)->DESCRI),oFontNormal)
		If (_cAlias01)->DEBCRE == 'C' //.and. (_cAlias01)->EVENTO != _cEveInss
			oReport:Say(nL,_nPos3,Transform(_nVlrEvento,"@E 999,999,999.99"),oFontNormal)
			_nTotCre += _nVlrEvento
		Else
			oReport:Say(nL,_nPos4,Transform(_nVlrEvento,"@E 999,999,999.99"),oFontNormal)
			_nTotDeb += _nVlrEvento
		EndIf

		If (_cAlias01)->EVENTO == _cEvetAdc
			nL += 50
			oReport:Say(nL,_nPos1,_cEveInss,oFontNormal)
			oReport:Say(nL,_nPos2,Alltrim("FUNRURAL/SENAR"),oFontNormal)		
			oReport:Say(nL,_nPos4,Transform(_nVlrINSS,"@E 999,999,999.99"),oFontNormal)
			_nTotDeb += _nVlrINSS
			_nInss += _nVlrINSS
		EndIf

		nL += 50		
		(_cAlias01)->(DbSkip())
	EndDo
	nL += 15
	oReport:Box(nL-10	,oReport:PageWidth() * 0.01,nL + 60,nTamMax)
	oReport:Say(nL,_nPos1,"TOTAIS:",oFontRotulo)
	oReport:Say(nL,_nPos3,Transform(_nTotCre,"@E 999,999,999.99"),oFontRotulo)
	oReport:Say(nL,_nPos4,Transform(_nTotDeb,"@E 999,999,999.99"),oFontRotulo)
	nL += 80
	
	//Resumo da Filial
	oReport:Say(nL,_nPos5,Alltrim("Produtores Ativos"),oFontRotulo)
	_nProdAtivo := BuscaDados(1,_cCodFil)		
	oReport:Say(nL,_nPos6,PADL(Transform(_nProdAtivo,"@E 999,999,999"),15),oFontNormal)
	
	nL += 60
	
	oReport:Say(nL,_nPos5,Alltrim("Total de Litragem"),oFontRotulo)
	oReport:Say(nL,_nPos6,PADL(Transform(_nLeite,"@E 999,999,999.99"),15),oFontNormal)
	
	nL += 60

	oReport:Say(nL,_nPos5,Alltrim("Total Bruto da Folha"),oFontRotulo)
	oReport:Say(nL,_nPos6,PADL(Transform(_nTotCre,"@E 999,999,999.99"),15),oFontNormal)
		
	nL += 60

	oReport:Say(nL,_nPos5,Alltrim("Total de Descontos"),oFontRotulo)
	oReport:Say(nL,_nPos6,PADL("("+Alltrim(Transform(_nTotDeb,"@E 999,999,999.99"))+")",15),oFontNormal)

	nL += 60

	oReport:Say(nL,_nPos5,Alltrim("Folha de Pagamento Bruta"),oFontRotulo)
	oReport:Say(nL,_nPos6,PADL(Transform(_nTotCre -_nTotDeb,"@E 999,999,999.99"),15),oFontNormal)

	nL += 80

	_aFunrSen := BuscaDados(2,_cCodFil,_cCodMIX)
	oReport:Say(nL,_nPos5-200,Alltrim("Base INSS Rural PF"),oFontRotulo)
	oReport:Say(nL,_nPos6-300,PADL(Transform(_aFunrSen[1],"@E 999,999,999.99"),15),oFontNormal)
	oReport:Say(nL,_nPos6+200,Alltrim("Valor INSS Rural PF"),oFontRotulo)
	oReport:Say(nL,_nPos4+100,PADL(Transform(_aFunrSen[2],"@E 999,999,999.99"),15),oFontNormal)
	nL += 60

	oReport:Say(nL,_nPos5-200,Alltrim("Base INSS Rural PJ"),oFontRotulo)
	oReport:Say(nL,_nPos6-300,PADL(Transform(_aFunrSen[3],"@E 999,999,999.99"),15),oFontNormal)
	oReport:Say(nL,_nPos6+200,Alltrim("Valor INSS Rural PJ"),oFontRotulo)
	oReport:Say(nL,_nPos4+100,PADL(Transform(_aFunrSen[4],"@E 999,999,999.99"),15),oFontNormal)
	nL += 60

	oReport:Say(nL,_nPos5-200,Alltrim("Base INSS Rural Total"),oFontRotulo)
	oReport:Say(nL,_nPos6-300,PADL(Transform(_aFunrSen[1]+_aFunrSen[3],"@E 999,999,999.99"),15),oFontNormal)
	oReport:Say(nL,_nPos6+200,Alltrim("Valor INSS Rural Total"),oFontRotulo)
	oReport:Say(nL,_nPos4+100,PADL(Transform(_aFunrSen[2]+_aFunrSen[4],"@E 999,999,999.99"),15),oFontNormal)
	nL += 60

	oReport:Say(nL,_nPos5-200,Alltrim("Base SENAR"),oFontRotulo)
	oReport:Say(nL,_nPos6-300,PADL(Transform(_aFunrSen[5],"@E 999,999,999.99"),15),oFontNormal)
	oReport:Say(nL,_nPos6+200,Alltrim("Valor SENAR"),oFontRotulo)
	oReport:Say(nL,_nPos4+100,PADL(Transform(_aFunrSen[6],"@E 999,999,999.99"),15),oFontNormal)


	nL += 100

	oReport:Say(nL,_nPos5-300,Alltrim("Preço Médio Bruto por Litro"),oFontRotulo)
	oReport:Say(nL,_nPos6-350,PADL(Transform(_nTotCre / _nLeite,"@E 9,999.9999"),10),oFontNormal)

	oReport:Say(nL,_nPos6+200,Alltrim("Preço Médio Liq. por Litro"),oFontRotulo)
	oReport:Say(nL,_nPos4+100,PADL(Transform((_nTotCre -_nVlrINSS) / _nLeite,"@E 9,999.9999"),10),oFontNormal)

	_nTotCre := 0
	_nTotDeb := 0
	_nInss := 0
	
	nL += 80

EndDo
(_cAlias01)->(dbCloseArea())

//Cria Area de trabalho do aglutinado por empresa
CriaTab(_cAlias02,2)

oReport:EndPage()
oReport:StartPage()
nL     := 250

(_cAlias02)->(dbgotop())
While !(_cAlias02)->(Eof()) .And. !oReport:Cancel()
	
	If nL >= oReport:PageHeight() - 200
		oReport:EndPage()
		oReport:StartPage()
		nL     := 250
	EndIf
	oReport:IncMeter()
	
	oReport:Box(nL-10	,oReport:PageWidth() * 0.01,nL + 60,nTamMax)
	oReport:Say(nL,nTamMid,"T O T A L I Z A Ç Ã O     G E R A L ",oFontRotulo)	
	oReport:Say(nL,_nPos4-50,"Volume: "+Transform((_cAlias02)->QTD,"@E 999,999,999,999")+" litros",oFontRotulo)
	_nLeite := (_cAlias02)->QTD
	//oReport:FillRect({nL,2300,nL+1,100},TBrush():New("",0))
	nL +=80
	oReport:Say(nL,_nPos1,"CÓDIGO:",oFontRotulo)
	oReport:Say(nL,_nPos2,"DESCRIÇÃO EVENTO ",oFontRotulo)
	oReport:Say(nL,_nPos3,"PROVENTOS",oFontRotulo)
	oReport:Say(nL,_nPos4,"DESCONTOS",oFontRotulo)
	nL += 50
	oReport:FillRect({nL,2300,nL+1,100},TBrush():New("",0))	
	nL += 50
	While !(_cAlias02)->(Eof()) .And. !oReport:Cancel()

		If nL >= oReport:PageHeight() - 200
			oReport:EndPage()
			oReport:StartPage()
			nL     := 250
			oReport:Say(nL,_nPos1,"CÓDIGO:",oFontRotulo)
			oReport:Say(nL,_nPos2,"DESCRIÇÃO EVENTO ",oFontRotulo)
			oReport:Say(nL,_nPos3,"PROVENTOS",oFontRotulo)
			oReport:Say(nL,_nPos4,"DESCONTOS",oFontRotulo)
			nL += 50
			oReport:FillRect({nL,2300,nL+1,100},TBrush():New("",0))	
			nL += 50
		EndIf

		If (_cAlias02)->EVENTO == _cEveInss 
			_nVlrINSS := (_cAlias02)->VALOR
			
			(_cAlias02)->(DbSkip())
			Loop
		EndIf


		_nVlrEvento := 0
		If (_cAlias02)->EVENTO == _cEvetAdc
			_nVlrEvento := _nVlrINSS + (_cAlias02)->VALOR
		Else
			_nVlrEvento:= (_cAlias02)->VALOR
		EndIf


		oReport:Say(nL,_nPos1,(_cAlias02)->EVENTO,oFontNormal)
		oReport:Say(nL,_nPos2,Alltrim((_cAlias02)->DESCRI),oFontNormal)
		
		//oReport:Say(nL,_nPos2,Alltrim((_cAlias02)->DESCRI),oFontNormal)		
		If (_cAlias02)->DEBCRE == 'C' //.and. (_cAlias02)->EVENTO != _cEveInss
			oReport:Say(nL,_nPos3,Transform(_nVlrEvento,"@E 999,999,999.99"),oFontNormal)
			_nTotCre += _nVlrEvento
		Else
			oReport:Say(nL,_nPos4,Transform(_nVlrEvento,"@E 999,999,999.99"),oFontNormal)
			_nTotDeb += _nVlrEvento
		EndIf

		If (_cAlias02)->EVENTO == _cEvetAdc
			nL += 50
			oReport:Say(nL,_nPos1,_cEveInss,oFontNormal)
			oReport:Say(nL,_nPos2,Alltrim("FUNRURAL/SENAR"),oFontNormal)		
			oReport:Say(nL,_nPos4,Transform(_nVlrINSS,"@E 999,999,999.99"),oFontNormal)
			_nTotDeb += _nVlrINSS
			_nInss += _nVlrINSS
		EndIf
		
		nL += 50		
		(_cAlias02)->(DbSkip())
	EndDo
	nL += 15
	oReport:Box(nL-10	,oReport:PageWidth() * 0.01,nL + 60,nTamMax)
	oReport:Say(nL,_nPos1,"TOTAIS:",oFontRotulo)
	oReport:Say(nL,_nPos3,Transform(_nTotCre,"@E 999,999,999.99"),oFontRotulo)
	oReport:Say(nL,_nPos4,Transform(_nTotDeb,"@E 999,999,999.99"),oFontRotulo)

	nL += 80
	
	//Resumo
	oReport:Say(nL,_nPos5,Alltrim("Produtores Ativos"),oFontRotulo)
	_nProdAtivo := BuscaDados(1,"")		
	oReport:Say(nL,_nPos6,PADL(Transform(_nProdAtivo,"@E 999,999,999"),15),oFontNormal)
	
	nL += 60
	
	oReport:Say(nL,_nPos5,Alltrim("Total de Litragem"),oFontRotulo)
	oReport:Say(nL,_nPos6,PADL(Transform(_nLeite,"@E 999,999,999.99"),15),oFontNormal)
	
	nL += 60

	oReport:Say(nL,_nPos5,Alltrim("Total Bruto da Folha"),oFontRotulo)
	oReport:Say(nL,_nPos6,PADL(Transform(_nTotCre,"@E 999,999,999.99"),15),oFontNormal)
		
	nL += 60

	oReport:Say(nL,_nPos5,Alltrim("Total de Descontos"),oFontRotulo)
	oReport:Say(nL,_nPos6,PADL("("+Alltrim(Transform(_nTotDeb,"@E 999,999,999.99"))+")",15),oFontNormal)

	nL += 60

	oReport:Say(nL,_nPos5,Alltrim("Folha de Pagamento Bruta"),oFontRotulo)
	oReport:Say(nL,_nPos6,PADL(Transform(_nTotCre -_nTotDeb,"@E 999,999,999.99"),15),oFontNormal)

	nL += 80

	_aFunrSen := BuscaDados(2,"",_cCodMIX)
	oReport:Say(nL,_nPos5-200,Alltrim("Base INSS Rural PF"),oFontRotulo)
	oReport:Say(nL,_nPos6-300,PADL(Transform(_aFunrSen[1],"@E 999,999,999.99"),15),oFontNormal)
	oReport:Say(nL,_nPos6+200,Alltrim("Valor INSS Rural PF"),oFontRotulo)
	oReport:Say(nL,_nPos4+100,PADL(Transform(_aFunrSen[2],"@E 999,999,999.99"),15),oFontNormal)
	nL += 60

	oReport:Say(nL,_nPos5-200,Alltrim("Base INSS Rural PJ"),oFontRotulo)
	oReport:Say(nL,_nPos6-300,PADL(Transform(_aFunrSen[3],"@E 999,999,999.99"),15),oFontNormal)
	oReport:Say(nL,_nPos6+200,Alltrim("Valor INSS Rural PJ"),oFontRotulo)
	oReport:Say(nL,_nPos4+100,PADL(Transform(_aFunrSen[4],"@E 999,999,999.99"),15),oFontNormal)
	nL += 60

	oReport:Say(nL,_nPos5-200,Alltrim("Base INSS Rural Total"),oFontRotulo)
	oReport:Say(nL,_nPos6-300,PADL(Transform(_aFunrSen[1]+_aFunrSen[3],"@E 999,999,999.99"),15),oFontNormal)
	oReport:Say(nL,_nPos6+200,Alltrim("Valor INSS Rural Total"),oFontRotulo)
	oReport:Say(nL,_nPos4+100,PADL(Transform(_aFunrSen[2]+_aFunrSen[4],"@E 999,999,999.99"),15),oFontNormal)
	nL += 60

	oReport:Say(nL,_nPos5-200,Alltrim("Base SENAR"),oFontRotulo)
	oReport:Say(nL,_nPos6-300,PADL(Transform(_aFunrSen[5],"@E 999,999,999.99"),15),oFontNormal)
	oReport:Say(nL,_nPos6+200,Alltrim("Valor SENAR"),oFontRotulo)
	oReport:Say(nL,_nPos4+100,PADL(Transform(_aFunrSen[6],"@E 999,999,999.99"),15),oFontNormal)


	nL += 100

	oReport:Say(nL,_nPos5-300,Alltrim("Preço Médio Bruto por Litro"),oFontRotulo)
	oReport:Say(nL,_nPos6-350,PADL(Transform(_nTotCre / _nLeite,"@E 9,999.9999"),10),oFontNormal)

	oReport:Say(nL,_nPos6+200,Alltrim("Preço Médio Liq. por Litro"),oFontRotulo)
	oReport:Say(nL,_nPos4+100,PADL(Transform((_nTotCre -_nVlrINSS) / _nLeite,"@E 9,999.9999"),10),oFontNormal)

	_aTotais[2] += _nTotCre
	_aTotais[3] += _nTotDeb
	_aTotais[4] += _nInss
	_nTotCre := 0
	_nTotDeb := 0
	_nInss := 0

EndDo
(_cAlias02)->(dbCloseArea())


oReport:EndPage()

oReport:Section(1):Finish()

Return

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³CriaTab ºAutor  ³Microsiga             º Data ³  04/11/16   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³ Cria tabela temporária para impressão do relatório.        º±±
±±º          ³                                                            º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ AP                                                         º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Static Function CriaTab(_cAlias,_nOpc)

Local _cFiltro := "% "
//O filtro e parâmetros não utiliza o código do MIX pois pode ocorrer de serem diferentes entre as filiais.
_cFiltro += " ZLF_DTINI >= '"+DTOS(_dDtIni)+"' AND ZLF_DTFIM <= '"+DTOS(_dDtFim)+"'  %" 

If Select(_cAlias) <> 0
	(_cAlias)->(DbCloseArea())
EndIf

If _nOpc == 1
	BeginSql Alias _cAlias
	
		SELECT ZLF_FILIAL AS CODFIL, 
		ZLF_CODZLE AS MIX,
		ZLF_EVENTO AS EVENTO, 
		ZL8_DESCRI AS DESCRI, 
		ZL8_DEBCRE AS DEBCRE, 
		ZLF_ORIGEM AS ORIGEM, 
		SUM(ZLF_QTDBOM) AS QTD,
		SUM(ZLF_TOTAL) AS VALOR,
				CASE WHEN ZL8_TPEVEN = 'L' AND ZL8_COD <> %Exp:_cEvetAdc%  THEN 0 
				WHEN ZL8_COD = %Exp:_cEveInss% THEN 1 
				WHEN ZL8_TPEVEN = 'L' AND ZL8_COD = %Exp:_cEvetAdc%  THEN 2				
				WHEN ZL8_TPEVEN = 'R' THEN 3 			
				WHEN ZL8_TPEVEN = 'A' THEN 4 
				WHEN ZL8_TPEVEN = 'F' AND ZL8_DEBCRE = 'C' THEN 5
				WHEN ZL8_TPEVEN = 'F' AND ZL8_DEBCRE = 'D' THEN 6			
				END AS ORDEM
		FROM %Table:ZLF% ZLF
			JOIN %Table:ZL8% ZL8 ON ZL8_COD = ZLF_EVENTO AND ZL8.%NotDel%
		WHERE %Exp:_cFiltro% AND ZLF.%NotDel%
		GROUP BY ZLF_FILIAL, ZLF_EVENTO, ZL8_DESCRI, ZL8_DEBCRE, ZLF_ORIGEM, ZL8_TPEVEN, ZL8_COD, ZLF_CODZLE
		ORDER BY ZLF_FILIAL, ORDEM, ZLF_EVENTO
	
	EndSql
ElseIf _nOpc == 2
	BeginSql Alias _cAlias
	
		SELECT 
		ZLF_EVENTO AS EVENTO, 
		ZL8_DESCRI AS DESCRI, 
		ZL8_DEBCRE AS DEBCRE, 
		ZLF_ORIGEM AS ORIGEM, 
		SUM(ZLF_QTDBOM) AS QTD,
		SUM(ZLF_TOTAL) AS VALOR,
				CASE WHEN ZL8_TPEVEN = 'L' AND ZL8_COD <> %Exp:_cEvetAdc%  THEN 0 
				WHEN ZL8_COD = %Exp:_cEveInss% THEN 1 
				WHEN ZL8_TPEVEN = 'L' AND ZL8_COD = %Exp:_cEvetAdc%  THEN 2				
				WHEN ZL8_TPEVEN = 'R' THEN 3 			
				WHEN ZL8_TPEVEN = 'A' THEN 4 
				WHEN ZL8_TPEVEN = 'F' AND ZL8_DEBCRE = 'C' THEN 5
				WHEN ZL8_TPEVEN = 'F' AND ZL8_DEBCRE = 'D' THEN 6			
				END AS ORDEM
		FROM %Table:ZLF% ZLF
			JOIN %Table:ZL8% ZL8 ON ZL8_COD = ZLF_EVENTO AND ZL8.%NotDel%
		WHERE %Exp:_cFiltro% AND ZLF.%NotDel%
		GROUP BY ZLF_EVENTO, ZL8_DESCRI, ZL8_DEBCRE, ZLF_ORIGEM, ZL8_TPEVEN,ZL8_COD
		ORDER BY ORDEM, ZLF_EVENTO
	
	EndSql

EndIf

Return

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³BuscaDados ºAutor  ³Guilherme França   º Data ³  07/03/18   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³ Busca informação para o relatorio.				          º±±
±±º          ³                                                            º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ AP                                                         º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Static Function BuscaDados(_nOpc,_cCodFil,_cCodMix)


Local _cAlias := GetNextAlias()
Local _nRet := 0
Local _cFiltro := "% "
Local _aRet := {0,0,0,0,0,0}


If Select(_cAlias) <> 0
	(_cAlias)->(DbCloseArea())
EndIf

If _nOpc == 1
	//O filtro e parâmetros não utiliza o código do MIX pois pode ocorrer de serem diferentes entre as filiais.
	If Empty(_cCodFil)
		_cFiltro += " ZLF_DTINI >= '"+DTOS(_dDtIni)+"' AND ZLF_DTFIM <= '"+DTOS(_dDtFim)+"'  %"
	Else
		_cFiltro += " ZLF_FILIAL = '"+_cCodFil+"' AND ZLF_DTINI >= '"+DTOS(_dDtIni)+"' AND ZLF_DTFIM <= '"+DTOS(_dDtFim)+"'  %"
	EndIf 


	BeginSql Alias _cAlias
	
		SELECT COUNT(ZLF_CODZLE) AS QTDPROD 
		FROM %Table:ZLF% ZLF
		WHERE  %Exp:_cFiltro% AND ZLF_SEQ = '001' AND ZLF.%NotDel%

	EndSql
	
	If !(_cAlias)->(Eof())
		_nRet := (_cAlias)->QTDPROD
	EndIf
	
ElseIf _nOpc == 2

	If Empty(_cCodFil)
		_cFiltro += " F1_EMISSAO = '"+DTOS(_dDtFim)+"'    %"
	Else
		_cFiltro += "  F1_FILIAL = '"+_cCodFil+"' AND F1_L_MIX = '"+_cCodMix+"'   %"
	EndIf 


	BeginSql Alias _cAlias
	
		SELECT F1_FILIAL, A2_TIPO, SUM(F1_BASEFUN) AS BASFUNR, SUM(F1_CONTSOC) AS FUNRUR, SUM(F1_VLSENAR) AS SENAR  
		FROM SF1010 F1
		    JOIN SA2010 A2 ON A2_COD = F1_FORNECE AND A2_LOJA = F1_LOJA AND A2_L_TPFOR = 'P' AND A2.%NotDel% 
		WHERE %Exp:_cFiltro% AND F1_L_MIX <> ' ' AND F1.%NotDel% 
		GROUP BY F1_FILIAL, A2_TIPO
	EndSql

	While !(_cAlias)->(Eof())
		If (_cAlias)->A2_TIPO == 'F'
			_aRet[1] += (_cAlias)->BASFUNR
			_aRet[2] += (_cAlias)->FUNRUR
		Else
			_aRet[3] += (_cAlias)->BASFUNR
			_aRet[4] += (_cAlias)->FUNRUR
		
		EndIf
		_aRet[5] += (_cAlias)->BASFUNR
		_aRet[6] += (_cAlias)->SENAR
	
		(_cAlias)->(DbSkip())
	EndDo
	(_cAlias)->(DbCloseArea())
	Return _aRet
	
EndIf

Return _nRet

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³ ValidPergº Autor ³ Microsiga          º Data ³  00/00/00   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³                                                            º±±
±±º          ³                                                            º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³                                                            º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Static function ValidPerg()

Local aHelpPor := {}
Local aHelpEng := {}
Local aHelpSpa := {}

aHelpPor := {}
Aadd( aHelpPor, 'Informe o ano do movimento.   ')
Aadd( aHelpPor, '.                      ')
U_xPutSx1(cPerg,"01","Ano"," "," ","mv_ch1","C",4,0,0,"G","mv_par01:= U_RGLT58ANO(mv_par01)","","","","MV_PAR01","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)


aHelpPor := {}
Aadd( aHelpPor, 'Informe o mês do movimento')
U_xPutSx1(cPerg,"02","Mês"," "," ","mv_ch2","C",2,0,0,"G","mv_par2:=STRZERO(val(mv_par02),2)","","","","MV_PAR02","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)


Return

User Function RGLT58ANO(cMV)

Local _cRet := ""

If Len(Alltrim(cMV)) == 2
	_cRet := '20'+Alltrim(cMV)
Else
	_cRet := Alltrim(cMV)
Endif

Return _cRet
