#INCLUDE "RWMAKE.ch"
#INCLUDE "TOPCONN.ch"
/*/

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัอออออออออออออออออออออออหออออออออออออออออออัออออออออออออออออออออออออออออออออออออออออออออออออปฑฑ
ฑฑบPrograma  ณ MGLT021  บ Autor ณ TOTVS                 บ Data da Criacao  ณ 03/03/2009                						บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯอออออออออออออออออออออออสออออออออออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบDescricao ณ Cria arquivo com dados do mapa de recebimento de leite.                                                      บฑฑ
ฑฑบ          ณ                        									                               				        บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ Enviar para A.F.                                                                                             บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบParametrosณ                                                                                      						บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบRetorno   ณ Nenhum						  							                               						บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUsuario   ณ Microsiga                                                                                					บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบSetor     ณ Gestao do Leite.                                                                        						บฑฑ
ฑฑฬออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบ            			          	ATUALIZACOES SOFRIDAS DESDE A CONSTRUAO INICIAL                   						บฑฑ
ฑฑฬออออออออออัออออออออออัออออออออออออออออออออออออออออออออออออออออออออออออออัออออออออออออออออออออออออออออออออออัอออออออออออออนฑฑ
ฑฑบAutor     ณ Data     ณ Motivo da Alteracao  				               ณUsuario(Filial+Matricula+Nome)    ณSetor        บฑฑ
ฑฑบฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤบฑฑ
ฑฑบ          ณ          ณ                                                  ณ                                  ณ   	        บฑฑ
ฑฑบ----------ณ----------ณ--------------------------------------------------ณ----------------------------------ณ-------------บฑฑ
ฑฑบ          ณ          ณ                    							   ณ                                  ณ 			บฑฑ
ฑฑบ----------ณ----------ณ--------------------------------------------------ณ----------------------------------ณ-------------บฑฑ
ฑฑศออออออออออฯออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออฯออออออออออออออออออออออออออออออออออฯอออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
/*/
User Function MGLT021()

Private cPerg := "MGLT021"
Private oGera

ValidPerg()
If !Pergunte(cPerg,.T.)
	Return
EndIf

//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณ Montagem da tela de processamento.                                  ณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
@ 200,1 TO 380,380 DIALOG oGera TITLE OemToAnsi("Exportacao Mapa Recebimento")
@ 02,10 TO 080,190
@ 10,018 Say " Este programa fara a leitura das tabelas SF1,SD1 e SA2 para   "
@ 18,018 Say " gerar os dados necessarios no arquivo de Exportacao do Mapa de"
@ 26,018 Say " Recebimento de coleta do leite. Este arquivo deve ser entregue"
@ 34,018 Say " na Administracao Fazendaria.                                  "

@ 70,098 BMPBUTTON TYPE 05 ACTION Pergunte(cPerg,.T.)
@ 70,128 BMPBUTTON TYPE 01 ACTION OkGera()
@ 70,158 BMPBUTTON TYPE 02 ACTION Close(oGera)

Activate Dialog oGera Centered

Return

/*/

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบFuncao    ณ OkGera   บ Autor ณ TOTVS              บ Data ณ  00/00/00   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDescricao ณ Funcao chamada pelo botao OK na tela inicial de processamenบฑฑ
ฑฑบ          ณ to. Executa a geracao do arquivo texto.                    บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ Programa principal                                         บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
/*/
Static Function OkGera

//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณ Inicializa a regua de processamento                                 ณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
Processa( {|lEnd| Geratxt(@lEnd)},"Aguarde","Gerando arquivo texto.",.T.)

Return

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบPrograma  ณGeratxt   บAutor  ณMicrosiga           บ Data ณ  03/04/10   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณ Funcao responsavel por gerar arquivo txt com informacoes daบฑฑ
ฑฑบ          ณ notas fiscais emitidas para produtores                     บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ Envio de arquivo para AF.                                  บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
*/
Static Function Geratxt(lEnd)

Local cArq      := " "
Local cTitulo   := "RELACAO DAS NOTAS FISCAIS EMITIDAS DE " + MV_PAR05 + "/" + MV_PAR07 + " ATE " + MV_PAR06 + "/" + MV_PAR08

Local _cTpFor	:= ""//U_ajusSQL(U_GETRELA1("1","ZL1_PLEITE")) //#LETRAS

Private cEOL    := "CHR(13)+CHR(10)"

cEOL := &cEOL
cCep :=  " "

//Verifica parametros para criar filtros
cFiltro := "%"

//Filtra Cod. Produtor
If !Empty(MV_PAR01) .And. !Empty(MV_PAR03)
	cFiltro += " AND SF1.F1_FORNECE BETWEEN '" + MV_PAR01 + "' AND '" + MV_PAR03 + "' "
EndIf

//Filtra Lj Produtor
If !Empty(MV_PAR02) .And. !Empty(MV_PAR04)
	cFiltro += " AND SF1.F1_LOJA BETWEEN '" + MV_PAR02 + "' AND '" + MV_PAR04 + "' "
EndIf

//Filtra Mes
If !Empty(MV_PAR05) .And. !Empty(MV_PAR06)
	cFiltro += " AND SUBSTR(F1_EMISSAO,5,2) BETWEEN '" + MV_PAR05 + "' AND '" + MV_PAR06 + "' "
EndIf

//Filtra Ano
If !Empty(MV_PAR07) .And. !Empty(MV_PAR08)
	cFiltro += " AND SUBSTR(F1_EMISSAO,1,4) BETWEEN '" + MV_PAR07 + "' AND '" + MV_PAR08 + "' "
EndIf

//Filtra Filial
If !Empty(MV_PAR09)
	cFiltro += " AND SF1.F1_FILIAL = '" + MV_PAR09 + "' "
EndIf

cFiltro += "%"
cAlias  := "TRBNF"

//Busca Notas Fiscais
BeginSql alias cAlias
	SELECT
	SF1.F1_FORNECE,SF1.F1_LOJA,SA2.A2_NOME,SF1.F1_DOC,SF1.F1_SERIE,SF1.F1_EMISSAO,SA2.A2_CGC,SA2.A2_INSCR,SF1.F1_FILIAL,
	SUM(SD1.D1_TOTAL) AS D1_TOTAL,SF1.F1_VALICM,SA2.A2_CEP
	FROM
	%table:SF1% SF1
	JOIN %table:SA2% SA2 ON SF1.F1_FORNECE = SA2.A2_COD AND SF1.F1_LOJA = SA2.A2_LOJA
	JOIN %table:SD1% SD1 ON SD1.D1_DOC = SF1.F1_DOC AND SD1.D1_SERIE = SF1.F1_SERIE AND SD1.D1_FILIAL = SF1.F1_FILIAL
	WHERE
	SF1.%notDel%
	AND SA2.%notDel% 
	AND SA2.A2_L_TPFOR IN ('P','G')  //#LETRAS
	//AND SA2.A2_C_TPFOR IN (%Exp:_cTpFor%)  //#LETRAS
	%Exp:cFiltro%
	GROUP BY
	SF1.F1_FORNECE,SF1.F1_LOJA,SA2.A2_NOME,SF1.F1_DOC,SF1.F1_SERIE,SF1.F1_EMISSAO,SA2.A2_CGC,SA2.A2_INSCR,
	SF1.F1_FILIAL,SF1.F1_VALICM,SA2.A2_CEP
	ORDER BY
	SA2.A2_CEP
EndSql

dbSelectArea("TRBNF")
nReg := 0
Count To nReg
ProcRegua(nReg)
dbGoTop()

//Grava Arquivo Txt
nHandle := 0
While TRBNF->(!Eof())
	//Verifica para saber se o cep ้ diferente e cria outro arquivo caso o mesmo for
	If cCep != TRBNF->A2_CEP
		fClose(nHandle) //Fecha arquivo atual
		
		cArq := ALLTRIM(MV_PAR10) + TRBNF->A2_CEP + "_"+  MV_PAR05 + MV_PAR06 + "-" + MV_PAR07 + MV_PAR08 + MV_PAR09 + ".TXT"
		nHandle := FCREATE(cArq, 1)
		cLinha := cTitulo + cEOL
		fWrite(nHandle, cLinha)
		//	cLinha := "Cep: " + MV_PAR08 + " ate " + MV_PAR09 + cEOL + cEOL
		//	fWrite(nHandle, cLinha)
		cCabec1 := "Inscricao          Nome do Produtor                         Period. N Fis. Data              Valor          ICMS       Quantid.  %Red. ICMS Dev."
		cCabec2 := "-----------        ---------------------------------        ------- ------ ----------   ----------    ----------     ---------- ------ ---------"
		
		cLinha := cCabec1 + cEOL
		fWrite(nHandle, cLinha)
		cLinha := cCabec2 + cEOL
		fWrite(nHandle, cLinha)
		cCep := TRBNF->A2_CEP
	EndIf
	
	IncProc()
	//inscricao
	//cLinha := TransForm("@S15",TRBNF->A2_INSCR) + " "
	cLinha := TRBNF->A2_INSCR
	//Nome fornecedor
	//cLinha += TransForm("@S33",TRBNF->A2_NOME) + " "
	cLinha += TRBNF->A2_NOME
	//Periodo
	cLinha += SubStr(TRBNF->F1_EMISSAO,5,2) + "/" + SubStr(TRBNF->F1_EMISSAO,1,4) + " "
	//Nf Entrada
	cLinha += ALLTRIM(TRBNF->F1_DOC) + " "
	//Emissao
	cLinha += ALLTRIM(TRBNF->F1_EMISSAO) + " "
	//Valor
	cLinha += TransForm(TRBNF->D1_TOTAL,"@E 999,999,999.99")
	//ICMS
	cLinha += TransForm(TRBNF->F1_VALICM,"@E 999,999,999.99")
	//Quantidade
	nQuant := Posicione("SD1",1,TRBNF->F1_FILIAL+TRBNF->F1_DOC+TRBNF->F1_SERIE+TRBNF->F1_FORNECE+TRBNF->F1_LOJA+ALLTRIM(GetMv("LT_ENTPRO")),"D1_QUANT")
	cLinha += TransForm(nQuant,"@E 999,999,999.99")
	
	
	
	// ICMS
	//tTransf := TransForm(TRB->F1_VALICM,"999,999.99")
	//cLinha += Replicate(" ", 10 - Len(ALLTRIM(tTransf))) + ALLTRIM(tTransf) + " "
	
	// Quantidade
	//tTransf := TransForm(Int(TRB->Z9_QTDBOM),"9999999")
	//cLinha += Replicate(" ", 10 - Len(ALLTRIM(tTransf))) + ALLTRIM(tTransf) + " "
	
	//cFaixa		:= TRB->A2_FXICMPR
	
	
	//ver com sr Toninho sobre faixas
	//nPerICMST	:= 0.05
	
	//nICMSDev	:= (TRB->F1_VALICM*nPerICMST)
	
	
	// % Red
	//tTransf := TransForm(nPerICMST,"9.99")
	//cLinha += Replicate(" ", 6 - Len(ALLTRIM(tTransf))) + ALLTRIM(tTransf) + " "
	
	// ICMS Dev
	//tTransf := TransForm(nICMSDev,"999,999.99")
	//cLinha += Replicate(" ", 9 - Len(ALLTRIM(tTransf))) + ALLTRIM(tTransf) + " "
	
	
	
	//nTotrrm := TRB->Z9_VLRPRM+TRB->Z9_ICMINC+TRB->Z9_ICMREP
	//nTotval := TRB->Z9_FRNBRUT+nTotrrm+TRB->Z9_VLRMGOR
	//nTotval := TRB->Z9_FRNLIQ + TRB->Z9_VLRINSS    // ALTERADO GEORGE
	
	
	//quebra linha
	cLinha += cEOL
	
	//grava
	fWrite(nHandle, cLinha)
	//fTotQtd 	:= fTotQtd   + Int(TRB->Z9_QTDBOM)
	//fTotValor 	:= fTotValor + nTotval //fTotValor + nTotrrm  alterado george
	//fTotICM 	:= fTotICM   + TRB->F1_VALICM
	//fTotICMD 	:= fTotICMD  + nICMSDev
	//proximo registro
	
	TRBNF->(dbSkip())
EndDo

//Fecha Arquivo
fClose(nHandle)
Close(oGera)
Return


/*/

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัอออออออออออออออออออออออหออออออออออออออออออัออออออออออออออออออออออออออออออออออออออออออออออออปฑฑ
ฑฑบPrograma  ณValidPerg บ Autor ณ Jeovane               บ Data da Criacao  ณ 04/03/2010                						บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯอออออออออออออออออออออออสออออออออออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบDescricao ณFuncao usada para validar se pergunta MGLT021 existe no dicionario de dados, caso nao existe cria as perguntasบฑฑ
ฑฑบ          ณ usadas neste relatorio   										                               				บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ MGLT021                         						                                                        บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบParametrosณ Nenhum                                                                                						บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบRetorno   ณ Nenhum                                                                               						บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUsuario   ณ Microsiga                                                                                					บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบSetor     ณ Gestao do Leite.                                                                        						บฑฑ
ฑฑฬออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบ            			          	ATUALIZACOES SOFRIDAS DESDE A CONSTRUAO INICIAL                   						บฑฑ
ฑฑฬออออออออออัออออออออออัออออออออออออออออออออออออออออออออออออออออออออออออออัออออออออออออออออออออออออออออออออออัอออออออออออออนฑฑ
ฑฑบAutor     ณ Data     ณ Motivo da Alteracao  				               ณUsuario(Filial+Matricula+Nome)    ณSetor        บฑฑ
ฑฑบฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤบฑฑ
ฑฑบ          ณ00/00/0000ณ                               				   ณ00-000000 -                       ณ TI	        บฑฑ
ฑฑบ----------ณ----------ณ--------------------------------------------------ณ----------------------------------ณ-------------บฑฑ
ฑฑบ          ณ          ณ                    							   ณ                                  ณ 			บฑฑ
ฑฑบ----------ณ----------ณ--------------------------------------------------ณ----------------------------------ณ-------------บฑฑ
ฑฑศออออออออออฯออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออฯออออออออออออออออออออออออออออออออออฯอออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
/*/
Static Function ValidPerg()

Local aHelpPor := {}
Local aHelpSpa := {}
Local aHelpEng := {}

//Do Produtor
aHelpPor := {}
Aadd( aHelpPor, 'Informe o c๓digo inicial do Produtor')
Aadd( aHelpPor, 'que deseja filtrar.                 ')
U_xPutSx1(cPerg,"01","Do Produtor"," "," ","mv_ch1","C",6,0,0,"G","","FOR","","","MV_PAR01","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)
//Loja
aHelpPor := {}
Aadd( aHelpPor, 'Informe loja inicial do Produtor  ')
Aadd( aHelpPor, 'que deseja filtrar.                 ')
U_xPutSx1(cPerg,"02","Da Loja "," "," ","mv_ch2","C",2,0,0,"G","","","","","MV_PAR02","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)
//Ate Produtor
aHelpPor := {}
Aadd( aHelpPor, 'Informe o c๓digo final do Produtor')
Aadd( aHelpPor, 'que deseja filtrar.                 ')
U_xPutSx1(cPerg,"03","Ate Produtor"," "," ","mv_ch3","C",6,0,0,"G","","FOR","","","MV_PAR03","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)
//Loja
aHelpPor := {}
Aadd( aHelpPor, 'Informe loja final do Produtor  ')
Aadd( aHelpPor, 'que deseja filtrar.                 ')
U_xPutSx1(cPerg,"04","Ate Loja "," "," ","mv_ch4","C",2,0,0,"G","","","","","MV_PAR04","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)
//Mes Inicial
aHelpPor := {}
Aadd( aHelpPor, 'Informe o M๊s inicial')
Aadd( aHelpPor, 'que deseja filtrar.                 ')
U_xPutSx1(cPerg,"05","Do M๊s"," "," ","mv_ch5","C",2,0,0,"G","","","","","MV_PAR05","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)
//Mes Final
aHelpPor := {}
Aadd( aHelpPor, 'Informe o M๊s final  ')
Aadd( aHelpPor, 'que deseja filtrar.                 ')
U_xPutSx1(cPerg,"06","At้ M๊s "," "," ","mv_ch6","C",2,0,0,"G","","","","","MV_PAR06","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)
//Ano Inicial
aHelpPor := {}
Aadd( aHelpPor, 'Informe o Ano inicial')
Aadd( aHelpPor, 'que deseja filtrar.                 ')
U_xPutSx1(cPerg,"07","Do Ano"," "," ","mv_ch7","C",4,0,0,"G","","","","","MV_PAR07","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)
//Ano Final
aHelpPor := {}
Aadd( aHelpPor, 'Informe o Ano final  ')
Aadd( aHelpPor, 'que deseja filtrar.                 ')
U_xPutSx1(cPerg,"08","At้ Ano "," "," ","mv_ch8","C",4,0,0,"G","","","","","MV_PAR08","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)
//Filial
aHelpPor := {}
Aadd( aHelpPor, 'Informe a filial')
Aadd( aHelpPor, 'que deseja filtrar.                 ')
U_xPutSx1(cPerg,"09","Filial"," "," ","mv_ch9","C",2,0,0,"G","","SM0","","","MV_PAR09","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)

aHelpPor := {}
Aadd( aHelpPor, 'Informe o caminho onde sera gerado o   ')
Aadd( aHelpPor, 'arquivo TXT.                           ')
U_xPutSx1(cPerg,"10","Gera arq. em:","Gera arq. em:","Gera arq. em:","mv_cha","C",60,0,0,"G","","","","","MV_PAR10","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)

Return