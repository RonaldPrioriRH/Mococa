#INCLUDE "PROTHEUS.CH"
#INCLUDE "REPORT.CH"
#INCLUDE "TOPCONN.CH"

/*/

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัอออออออออออออหอออออออัอออออออออออออออออออออออหออออออออออออออออออัอออออออออออออออออออออออออออออออออออออออออออออปฑฑ
ฑฑบPrograma  ณ RGLT070     บ Autor ณ Ramon Teles           บ Data da Criacao  ณ 02/01/2014             						บฑฑ
ฑฑฬออออออออออุอออออออออออออสอออออออฯอออออออออออออออออออออออสออออออออออออออออออฯอออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบDescricao ณ Prestacoes/ Outros Debitos   																                บฑฑ
ฑฑบ          ณ 	 							                                                                                บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ Gestao do Leite                                                   											บฑฑ
ฑฑบ          ณ 	 							                                                                                บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบParametrosณ                                                                                        						บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบRetorno   ณ Nenhum					                                                                                  	บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUsuario   ณ															                             						บฑฑ
ฑฑฬออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบSetor     ณ Gestao do Leite	                                                                       						บฑฑ
ฑฑฬออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบ            						ATUALIZACOES SOFRIDAS DESDE A CONSTRUCAO INICIAL                   						บฑฑ
ฑฑฬออออออออออัออออออออออัออออออออออออออออออออออออออออออออออออออออออออออออออัออออออออออออออออออออออออออออออออออัอออออออออออออนฑฑ
ฑฑบAutor     ณ Data     ณ Motivo da Alteracao  				               ณUsuario(Filial+Matricula+Nome)    ณSetor        บฑฑ
ฑฑฬฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤนฑฑ
ฑฑบ          ณ          ณ                    							   ณ                                  ณ 			บฑฑ
ฑฑศออออออออออฯออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออฯออออออออออออออออออออออออออออออออออฯอออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
*/

User Function RGLT070(_cCMatr,_cLoja,_cMesAno)

	Private cPerg := "RGLT070"
	
	Private oReport
	Private lInverte	:= .F.     
	Private _dDtEmi
//	Private cMarca	:= GetMark()   
	Private _lTOTEM 	:= .F.

	SetPrvt("oDlg","oSay")
	
	//Impressao Relatorio por Token
	If Empty(_cCMatr)
		CriaSX1()
		Pergunte(cPerg,.T.,'Relat๓rio Presta็๕es/Outros D้bitos')    
		_dDtEmi := SubString(mv_par03,1,2)+"/"+SubString(mv_par03,3,4)
		IF StrZero((Val(SubString(mv_par03,1,2))+1),2) == "13"
			mv_par03	:= "01"+StrZero((Val(SubString(mv_par03,3,4))+1),4)    
   		ELSE
			mv_par03	:= 	StrZero((Val(SubString(mv_par03,1,2))+1),2)+SubString(mv_par03,3,4)
		ENDIF
	Else
		_lTOTEM := .T.              
		IF MONTH(DDATABASE) - 1 == 0
			_dDtEmi	:= "12"+ALLTRIM(STR(YEAR(DDATABASE)-1))
		ELSE
			_dDtEmi	:= STRZERO((MONTH(DDATABASE)-1),2,0)+ALLTRIM(STR(YEAR(DDATABASE)))
		ENDIF
		mv_par01 := _cCMatr
		mv_par02 := _cCMatr
		mv_par03 := _cMesAno	
	EndIf
	
	sfPrint()
		
Return

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑฺฤฤฤฤฤฤฤฤฤฤยฤฤฤฤฤฤฤฤฤฤยฤฤฤฤฤฤฤยฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤยฤฤฤฤฤฤยฤฤฤฤฤฤฤฤฤฤฟฑฑ
ฑฑณFuncao    ณsfPrint   ณ Autor ณ Ramon Teles           ณ Data ณ 02/01/14 ณฑฑ
ฑฑรฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤมฤฤฤฤฤฤฤมฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤมฤฤฤฤฤฤมฤฤฤฤฤฤฤฤฤฤดฑฑ
ฑฑณDescricao ณ                                                            ณฑฑ
ฑฑรฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤดฑฑ
ฑฑณ Uso      ณ                                                            ณฑฑ
ฑฑภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤูฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
*/

Static Function sfPrint()

	Local cPerg
	
	oReport := ReportDef(cPerg)
	//oReport:PrintDialog()
		
Return

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑฺฤฤฤฤฤฤฤฤฤฤยฤฤฤฤฤฤฤฤฤฤยฤฤฤฤฤฤฤยฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤยฤฤฤฤฤฤยฤฤฤฤฤฤฤฤฤฤฟฑฑ
ฑฑณFuncao    ณReportDef ณ Autor ณ Ramon Teles           ณ Data ณ 02/01/14 ณฑฑ
ฑฑรฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤมฤฤฤฤฤฤฤมฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤมฤฤฤฤฤฤมฤฤฤฤฤฤฤฤฤฤดฑฑ
ฑฑณDescricao ณ                                                            ณฑฑ
ฑฑรฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤดฑฑ
ฑฑณ Uso      ณ                                                            ณฑฑ
ฑฑภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤูฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
*/

Static Function ReportDef(cPerg)

	Private oReport,oSecZ0
	Private aTam := {}
	
	oReport := TReport():New("RGLT070","Relat๓rio Presta็๕es/Outros D้bitos",cPerg,{|oReport|PrintReport(oReport)},"Este relatorio irแ apresentar as presta็๕es/outros debitos futuros.")
	
	oReport:lParamPage	:= .F.
	oReport:lHeaderVisible := .F.
	oReport:lFooterVisible := .F. 
	If _lTOTEM   
		oReport:cPrinterName	:= ALLTRIM(GETMV("MV_C_PRINT"))//"PDFCreator"//"HP LaserJet M1530 MFP Series PCL 6 - COOPRATA" //"Foxit Reader PDF Printer"
   		oReport:SetPreview(.F.)
		oReport:SetDevice(2)
   		oReport:SetEnvironment(2)  
		oReport:SetMsgPrint("Imprimindo...") 
	EndIf
	oReport:SetPortrait(.T.)
	oReport:nLineHeight	:= 45 
	oReport:Print(.F.,,.T.) 
	
Return oReport

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑฺฤฤฤฤฤฤฤฤฤฤยฤฤฤฤฤฤฤฤฤฤฤฤยฤฤฤฤฤฤฤยฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤยฤฤฤฤฤฤยฤฤฤฤฤฤฤฤฤฤฟฑฑ
ฑฑณFuncao    ณPrintReport ณ Autor ณ Ramon Teles           ณ Data ณ 02/01/14 บฑฑ
ฑฑรฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤมฤฤฤฤฤฤฤมฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤมฤฤฤฤฤฤมฤฤฤฤฤฤฤฤฤฤดฑฑ
ฑฑณDescricao ณ Responsavel por montar o relatorio                           ณฑฑ
ฑฑรฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤดฑฑ
ฑฑณ Uso      ณ                                                              ณฑฑ
ฑฑภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤูฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
*/

Static Function PrintReport()
	
	//Declaracao das Fontes
	Local oFont8 		:= TFont():New("COURIER NEW",08,08,,.F.,,,,.T.,.F.)
	Local oFont8N		:= TFont():New("COURIER NEW",08,08,,.T.,,,,.T.,.F.)
	Local oFont10 		:= TFont():New("COURIER NEW",10,10,,.F.,,,,.T.,.F.)
	Local oFont10N		:= TFont():New("COURIER NEW",10,10,,.T.,,,,.T.,.F.)
	Local oFont10NS		:= TFont():New("COURIER NEW",10,10,,.T.,,,,.T.,.T.)
	Local oFont12 		:= TFont():New("COURIER NEW",12,12,,.F.,,,,.T.,.F.)
	Local oFont12N		:= TFont():New("COURIER NEW",12,12,,.T.,,,,.T.,.F.)
	Local oFont12NS		:= TFont():New("COURIER NEW",12,12,,.T.,,,,.T.,.T.)
	Local oFont14 		:= TFont():New("COURIER NEW",14,14,,.F.,,,,.T.,.F.)
	Local oFont14N		:= TFont():New("COURIER NEW",14,14,,.T.,,,,.T.,.F.)
	Local oFont16 		:= TFont():New("COURIER NEW",16,16,,.F.,,,,.T.,.F.)
	Local oFont16N		:= TFont():New("COURIER NEW",16,16,,.T.,,,,.T.,.F.)
	Local oFont16NS		:= TFont():New("COURIER NEW",16,16,,.T.,,,,.T.,.T.)
	
	Local nTamMax		:= oReport:PageWidth()- 50 //Tamanho mแximo da pแgina
	Local nTamMid		:= (oReport:PageWidth()/2) //Metade da pแgina
	Local nWrtMid		:= nTamMid + 10 //Impressใo de dados a partir do meio da pแgina
	
	//Data 
	Local _dIniVcto := SubString(mv_par03,3,4)+SubString(mv_par03,1,2)+"21"	 
	
	//Totalizadores
	Local _nTotTitAtu 

	Local cQuery := ""                                           	

	oReport:SkipLine(6)
	
	oReport:Say(oReport:Row(),oReport:PageWidth() * 0.02," ",oFont12N)	

	//Consulta para buscar informacoes	
	cQuery := " SELECT SE2.E2_FORNECE AS FORNECE,SA2.A2_NOME AS NOME,SA2.A2_COD AS CODIGO,SA2.A2_END AS ENDERECO,SA2.A2_BANCO AS BANCO, SA2.A2_AGENCIA AS AGENCIA, SA2.A2_NUMCON AS CONTA, E2_EMISSAO AS DTEMI,"
	cQuery += " E2_NUM AS NUMERO,E2_PARCELA AS PARCELA ,E2_MSFIL AS FILIAL,E2_VENCTO AS DTVENC,E2_HIST AS HIST,E2_VALOR AS VALOR,E2_JUROS AS JUROS,E2_TIPO AS TIPO,E2_L_EVENT AS EVENTO,E2_SDACRES AS ACRES,E2_SDDECRE AS DECRE "
	cQuery += " FROM "+RetSqlName("SE2")+" SE2 , "+RetSqlName("SA2")+" SA2 "
	cQuery += " WHERE SE2.E2_FORNECE = SA2.A2_COD "
	cQuery += " AND SE2.E2_LOJA = SA2.A2_LOJA "
	cQuery += " AND " + RetSqlCond("SE2") + " "
	cQuery += " AND " + RetSqlCond("SA2") + " "
	cQuery += " AND E2_SALDO > 0 "
	cQuery += " AND E2_TIPO = 'NDF' "
	cQuery += " AND SE2.E2_L_EVENT <> ' ' "	
	cQuery += " AND SA2.A2_COD BETWEEN '"+mv_par01+"' AND '"+mv_par02+"'"
	cQuery += " AND SE2.E2_VENCTO >= '"+_dIniVcto+"' "
	cQuery += " ORDER BY SE2.E2_FORNECE, SE2.E2_EMISSAO "
		
	If Select ("EXT") <> 0
		EXT->(dbCloseArea())
	EndIf
	
	cQuery := changeQuery(cQuery)
	
	dbUseArea(.T.,"TOPCONN",TCGenQry(,,cQuery),"EXT",.F.,.T.)
	
	EXT->(dbGoTop())
	
	Private _lImp := .F.

	While EXT->(!Eof())
	
	_lImp := .T.
		
		_nTotTitAtu := 0
		_cCoop := EXT->FORNECE
		
		//Titulo
		oReport:Say(oReport:Row(),oReport:PageWidth() * 0.40	, "Presta็๕es/Outros D้bitos" 		,oFont16N)
	
		oReport:SkipLine(2)
		
		//Criando Secao do Faturamento
		oReport:Say(oReport:Row(),oReport:PageWidth() * 0.01	, "Cooperado: " + Alltrim(EXT->NOME)	+ " - " + EXT->CODIGO	,oFont12N)
		oReport:SkipLine(1)
		oReport:Say(oReport:Row(),oReport:PageWidth() * 0.01	, "Endere็o:  " + EXT->ENDERECO  		,oFont12N)
		oReport:SkipLine(1)	
		oReport:Say(oReport:Row(),oReport:PageWidth() * 0.01	, "Banco: " + POSICIONE("SA6",1,XFILIAL("SA6")+EXT->BANCO,"A6_NOME") 		,oFont12N)
		oReport:Say(oReport:Row(),oReport:PageWidth() * 0.30	, "Ag๊ncia: " + EXT->AGENCIA 		,oFont12N)
		oReport:Say(oReport:Row(),oReport:PageWidth() * 0.50	, "Conta: " + EXT->CONTA 			,oFont12N)
				
		oReport:SkipLine(2)
		oReport:ThinLine()
		oReport:SkipLine(1)   
		
		//Criando Colunas
		oReport:Say(oReport:Row(),oReport:PageWidth() * 0.01,"Emissใo"			,oFont12N)
		oReport:Say(oReport:Row(),oReport:PageWidth() * 0.13,"Doc/Parcela"		,oFont12N)
		oReport:Say(oReport:Row(),oReport:PageWidth() * 0.27,"Filial"			,oFont12N)
		oReport:Say(oReport:Row(),oReport:PageWidth() * 0.34,"Vencimento"		,oFont12N)
		oReport:Say(oReport:Row(),oReport:PageWidth() * 0.46,"Hist๓rico"		,oFont12N)
		oReport:Say(oReport:Row(),oReport:PageWidth() * 0.79,"D/C"				,oFont12N)
		oReport:Say(oReport:Row(),oReport:PageWidth() * 0.87,"Valor"			,oFont12N)
	
		oReport:SkipLine(2)
		
		While EXT->(!Eof()) .AND. EXT->FORNECE = _cCoop
		
			If oReport:Row() >= oReport:PageHeight() - 100
				
				oReport:EndPage()
				oReport:StartPage() 
				
				PrintC()
			
			Else
				oReport:SkipLine(1)
			EndIf
			
 			oReport:Say(oReport:Row(),oReport:PageWidth() * 0.01,DTOC(STOD(EXT->DTEMI))			,oFont12)
			oReport:Say(oReport:Row(),oReport:PageWidth() * 0.13,EXT->NUMERO +"-" +EXT->PARCELA	,oFont12)
			oReport:Say(oReport:Row(),oReport:PageWidth() * 0.27,FGLT0703(EXT->FILIAL)				,oFont12)
			oReport:Say(oReport:Row(),oReport:PageWidth() * 0.34,DTOC(STOD(EXT->DTVENC))				,oFont12)
		 	oReport:Say(oReport:Row(),oReport:PageWidth() * 0.46,EXT->HIST			,oFont12)    
		 	If EXT->TIPO == "NDF"
	 	   		oReport:Say(oReport:Row(),oReport:PageWidth() * 0.80, "D"			,oFont12) 
				_nTotTitAtu := _nTotTitAtu + (EXT->VALOR+EXT->ACRES-EXT->DECRE)
	 		Else
	 	   		oReport:Say(oReport:Row(),oReport:PageWidth() * 0.80, "C"			,oFont12)
				_nTotTitAtu := _nTotTitAtu - (EXT->VALOR+EXT->ACRES-EXT->DECRE)
	 		EndIf
		 	oReport:Say(oReport:Row(),oReport:PageWidth() * 0.88,cValtoChar(Transform((EXT->VALOR+EXT->ACRES-EXT->DECRE),"@E 999,999.99"))			,oFont12)
		 	
		 	EXT->(dbSkip())

		EndDo
		
		oReport:SkipLine(2)
				
		//Seccao Resumo Final
		If oReport:Row() >= oReport:PageHeight() - 80
				oReport:EndPage()
				oReport:StartPage() 
				oReport:Say(oReport:Row(),oReport:PageWidth() * 0.02," ",oFont12N)	
				oReport:SkipLine(2)
		EndIf 
				
		
		oReport:Say(oReport:Row(),oReport:PageWidth() * 0.02," ",oFont12N)	
		oReport:Box(oReport:Row(),oReport:PageWidth() * 0.01,oReport:Row() + 120,nTamMax)	
		oReport:Say(oReport:Row(),oReport:PageWidth() * 0.43,"Resumo Final"			,oFont14N)
		oReport:SkipLine(1)
		oReport:Say(oReport:Row(),oReport:PageWidth() * 0.62,"Valor Devedor dos Meses Futuros: "			,oFont12)
		oReport:Say(oReport:Row(),oReport:PageWidth() * 0.88,cValtoChar(Transform(_nTotTitAtu,"@E 999,999.99"))			,oFont12)

		oReport:EndPage()
		oReport:StartPage() 
	EndDo
	

	EXT->(DBCLOSEAREA())
	oReport:EndPage()
	
Return

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบFuncao    ณ FGLT0703 บ Autor ณ Ramon Teles        บ Data ณ  09/08/13   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDescricao ณ Funcao para retornar as inicias da filial. 				  บฑฑ
ฑฑบ          ณ 					                                          บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ Programa principal                                         บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
*/

Static Function FGLT0703(_cCodFil)

	Local _aArea    := GetArea()
	
	Local _cRet := " "
 
		
	//DbSelectArea("SM0")
	//DbSetOrder(1)
	SM0->(DbGoTop())
	
	While SM0->(!Eof())
	
		If SM0->M0_CODFIL = _cCodFil
			_cRet := SubString(SM0->M0_FILIAL,1,3)
			Exit
		EndIf
		SM0->(DbSkip())
	
	EndDo
	
	//DbCloseArea("SM0")
	
	RestArea(_aArea)
	
Return _cRet



/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบFuncao    ณ PrintC   บ Autor ณ Ramon Teles        บ Data ณ  12/08/13   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDescricao ณ Funcao para printar o cabe็alho.							  บฑฑ
ฑฑบ          ณ 					                                          บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ Programa principal                                         บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
*/

Static Function PrintC

	Local _aArea    := GetArea()
	Local oFont12N		:= TFont():New("COURIER NEW",12,12,,.T.,,,,.T.,.F.)
	
	//Criando Colunas
	oReport:Say(oReport:Row(),oReport:PageWidth() * 0.02," ",oFont12N)	
	oReport:SkipLine(2)
	oReport:Say(oReport:Row(),oReport:PageWidth() * 0.01,"Emissใo"				,oFont12N)
	oReport:Say(oReport:Row(),oReport:PageWidth() * 0.13,"Doc/Parcela"			,oFont12N)
	oReport:Say(oReport:Row(),oReport:PageWidth() * 0.27,"Filial"				,oFont12N)
	oReport:Say(oReport:Row(),oReport:PageWidth() * 0.34,"Vencimento"			,oFont12N)
	oReport:Say(oReport:Row(),oReport:PageWidth() * 0.46,"Hist๓rico"			,oFont12N)
	oReport:Say(oReport:Row(),oReport:PageWidth() * 0.79,"D/C"					,oFont12N)
	oReport:Say(oReport:Row(),oReport:PageWidth() * 0.87,"Valor"				,oFont12N)
	
	oReport:SkipLine(2)

	RestArea(_aArea)
	
Return


/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบFuncao    ณ CriaSX1  บ Autor ณ Ramon Teles        บ Data ณ  02/01/14   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDescricao ณ Funcao para criacao das perguntas caso elas nao existam.   บฑฑ
ฑฑบ          ณ                                                            บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ Programa principal                                         บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
*/
Static Function CriaSX1()

	Local aHelpPor := {}
	Local aHelpSpa := {}
	Local aHelpEng := {}	
	
	//Do Produtor
	aHelpPor := {}
	Aadd( aHelpPor, 'Informe o codigo inicial do Produtor   ')
	Aadd( aHelpPor, 'que deseja filtrar.                 ')
	U_xPutSx1(cPerg,"01","Do Produtor"," "," ","mv_ch1","C",6,0,0,"G","","SA2_LC","","","mv_par01","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)
	
	//Ao Produtor
	aHelpPor := {}
	Aadd( aHelpPor, 'Informe o codigo final do Produtor     ')
	Aadd( aHelpPor, 'que deseja filtrar.                 ')
	U_xPutSx1(cPerg,"02","Ao Produtor"," "," ","mv_ch2","C",6,0,0,"G","","SA2_LC","","","mv_par02","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)
				
	//Data Saldo
	aHelpPor := {}
	Aadd( aHelpPor, 'Informe a data para buscar debitos futuros')
	Aadd( aHelpPor, 'Formato (mmaaaa)                        ')
	U_xPutSx1(cPerg,"03","Data Saldo (mmaaaa)"," "," ","mv_ch3","C",6,0,0,"G","NaoVazio()","","","","mv_par03","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)
						
Return
