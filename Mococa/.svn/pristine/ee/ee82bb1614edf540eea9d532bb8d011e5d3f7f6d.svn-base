#INCLUDE "TopConn.ch"
#INCLUDE "RwMake.ch"
/*/

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัอออออออออออออออออออออออหออออออออออออออออออัออออออออออออออออออออออออออออออออออออออออออออออออปฑฑ
ฑฑบPrograma  ณ RGLT031  บ Autor ณ TOTVS                 บ Data da Criacao  ณ 27/01/2009                						บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯอออออออออออออออออออออออสออออออออออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบDescricao ณ Relacao de produtores por municipio.                                                                         บฑฑ
ฑฑบ          ณ 															                               						บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ                                          															  		บฑฑ
ฑฑบ          ณ 															                               						บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบParametrosณ Nenhum						   							                               						บฑฑ
ฑฑบ			 ณ														                                   						บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบRetorno   ณ Nenhum													                               						บฑฑ
ฑฑบ			 ณ														                                   						บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUsuario   ณ															                             						บฑฑ
ฑฑฬออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบSetor     ณ Gestao do Leite                                                                      						บฑฑ
ฑฑฬออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบ            						ATUALIZACOES SOFRIDAS DESDE A CONSTRUAO INICIAL                   						บฑฑ
ฑฑฬออออออออออัออออออออออัออออออออออออออออออออออออออออออออออออออออออออออออออัออออออออออออออออออออออออออออออออออัอออออออออออออนฑฑ
ฑฑบAutor     ณ Data     ณ Motivo da Alteracao  				               ณUsuario(Filial+Matricula+Nome)    ณSetor        บฑฑ
ฑฑฬฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤนฑฑ
ฑฑบ          ณ          ณ                    							   ณ                                  ณ 			บฑฑ
ฑฑศออออออออออฯออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออฯออออออออออออออออออออออออออออออออออฯอออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
/*/
User Function RGLT031

//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณ Declaracao de Variaveis                                             ณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
Local cDesc1       := "Este programa tem como objetivo imprimir relatorio "
Local cDesc2       := "de acordo com os parametros informados pelo usuario."
Local cDesc3       := "RELACAO DE PRODUTORES POR MUNICIPIO"
Local cPict        := ""
Local titulo       := "RELACAO DE PRODUTORES POR MUNICIPIO"
Local nLin         := 80
Local Cabec1       := " CODIGO LOJA   PRODUTOR                      FAZENDA             MUNICIPIO      CGC            INSCRICAO     NRP-SIGSIf          VOLUME    MEDIA DIARIA"
Local Cabec2       := ""
Local imprime      := .T.
Local aOrd         := {}

Private lEnd         := .F.
Private lAbortPrint  := .F.
Private CbTxt        := ""
Private limite       := 132
Private tamanho      := "G"
Private nomeprog     := "RGLT031" // Coloque aqui o nome do programa para impressao no cabecalho
Private nTipo        := 18
Private aReturn      := { "Zebrado", 1, "Administracao", 2, 2, 1, "", 1}
Private nLastKey     := 0
Private cbtxt        := Space(10)
Private cbcont       := 00
Private CONTFL       := 01
Private m_pag        := 01
Private wnrel        := "RGLT031" // Coloque aqui o nome do arquivo usado para impressao em disco
Private cPerg 	     := "RGLT031   "
Private cString      := "SA2"

ValidPerg()
pergunte(cPerg,.F.)

dbSelectArea("SA2")
dbSetOrder(1)


//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณ Monta a interface padrao com o usuario...                           ณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู

wnrel := SetPrint(cString,NomeProg,cPerg,@titulo,cDesc1,cDesc2,cDesc3,.T.,aOrd,.T.,Tamanho,,.T.)

If nLastKey == 27
	Return
EndIf

SetDefault(aReturn,cString)

If nLastKey == 27
	Return
EndIf

nTipo := If(aReturn[4]==1,15,18)

//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณ Processamento. RPTSTATUS monta janela com a regua de processamento. ณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู

RptStatus({|| RunReport(Cabec1,Cabec2,Titulo,nLin) },Titulo)
Return

/*/

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบFuno    ณRUNREPORT บ Autor ณ AP6 IDE            บ Data ณ  10/03/09   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDescrio ณ Funcao auxiliar chamada pela RPTSTATUS. A funcao RPTSTATUS บฑฑ
ฑฑบ          ณ monta a janela com a regua de processamento.               บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ Programa principal                                         บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
/*/

Static Function RunReport(Cabec1,Cabec2,Titulo,nLin)

Local nOrdem
Local nQtdReg
Local nQtdTq:=0
Local nQtdUs:=0
Local nTotVol:=0
Local nSubVol:=0
Local cUltMun:=""

cQuery := " SELECT * "
cQuery += " FROM "+RetSqlName("SA2")+" SA2, "+RetSqlName("ZL3")+" ZL3, "+RetSqlName("ZL2")+" ZL2"
cQuery += " WHERE SA2.D_E_L_E_T_ = ' '"
cQuery += " AND ZL3.D_E_L_E_T_ = ' '"
cQuery += " AND ZL2.D_E_L_E_T_ = ' '"
cQuery += " AND A2_L_LI_RO = ZL3_COD"
cQuery += " AND ZL2_COD = ZL3_SETOR"
cQuery += " AND ZL3_COD BETWEEN '"+mv_par02+"' AND '"+mv_par03+"' "
cQuery += " AND ZL2_COD = '"+mv_par01+"' "

If !empty(alltrim(mv_par04))
	cQuery += " AND A2_COD_MUN = '"+mv_par04+"' "
EndIf

If mv_par06 == 1
	cQuery += " ORDER BY A2_COD_MUN,A2_NOME,A2_COD,A2_LOJA "
Else
	cQuery += " ORDER BY A2_NOME,A2_COD,A2_LOJA"
EndIf

If Select("TMP") <> 0
	TMP->(dbclosearea("TMP"))
EndIf

dbUseArea( .T., "TOPCONN", TcGenQry(,,cQuery), "TMP", .T., .F. )

COUNT TO nQtdReg

SetRegua(nQtdReg)

TMP->(dbgotop())

while !TMP->(eof())
	
	IncRegua()
	
	//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
	//ณ VerIfica o cancelamento pelo usuario...                             ณ
	//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	
	If lAbortPrint
		@nLin,00 PSAY "*** CANCELADO PELO OPERADOR ***"
		Exit
	EndIf
	
	//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
	//ณ Impressao do cabecalho do relatorio. . .                            ณ
	//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	
	If nLin > 55 // Salto de Pแgina. Neste caso o formulario tem 55 linhas...
		Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
		nLin := 8
	EndIf
	
	If cUltMun != TMP->A2_COD_MUN .and. mv_par06 == 1
		
		If cUltMun != ""
			@nLin,000 psay __PrtThinLine()
			nLin++
			@nLin,000 psay "Total de Produtores:"+alltrim(str(nQtdTq))
			@nLin,125 PSAY transform(nTotVol,"@E 999,999,999")
			nMedia := nTotVol/val(substr(dtos(lastday(mv_par05)),7,2))
			@nLin,140 PSAY transform(nMedia,"@E 999,999,999")
			nLin+=2
			nTotVol:=0
			nQtdTq:=0
		EndIf
		
		@nLin,000 PSAY "Municipio: "+POSICIONE("CC2",1,XFILIAL("CC2")+TMP->A2_EST+TMP->A2_COD_MUN,"CC2_MUN")
		nLin++
	EndIf
	cUltMun	:=	TMP->A2_COD_MUN
	
	
	nVol:=u_VolLeite(xfilial("ZLD"),firstDay(mv_par05),lastday(mv_par05),mv_par01,,TMP->A2_COD,TMP->A2_LOJA,)
	
	If nVol > 0
		
		nQtdTq++
		@nLin,000 PSAY TMP->A2_COD
		@nLin,008 PSAY TMP->A2_LOJA
		@nLin,015 PSAY left(TMP->A2_NOME,29)
		@nLin,045 PSAY left(TMP->A2_L_FAZEN,19)
		@nLin,065 PSAY left(POSICIONE("CC2",1,XFILIAL("CC2")+TMP->A2_EST+TMP->A2_COD_MUN,"CC2_MUN"),14)
		@nLin,080 PSAY TMP->A2_CGC
		@nLin,095 PSAY TMP->A2_INSCR
		@nLin,110 PSAY TMP->A2_L_SIGSI
		@nLin,125 PSAY transform(nVol,"@E 999,999,999")
		nMedia := nVol/val(substr(dtos(lastday(mv_par05)),7,2))
		@nLin,140 PSAY transform(nMedia,"@E 999,999,999")
		nLin++
		
		nTotVol+=nVol
		nSubVol+=nVol
		
	EndIf
	
	// mostra usuarios do tanque
	cQuery := " SELECT * "
	cQuery += " FROM "+RetSqlName("SA2")+" SA2 "
	cQuery += " WHERE SA2.D_E_L_E_T_ = ' '"
	cQuery += " AND A2_L_TANQ = '"+TMP->A2_COD+"' "
	cQuery += " AND A2_COD != '"+TMP->A2_COD+"' "
	dbUseArea( .T., "TOPCONN", TcGenQry(,,cQuery), "TRBA2", .T., .F. )
	If !TRBA2->(eof())
		while !TRBA2->(eof())
			
			nVol:=u_VolLeite(xfilial("ZLD"),firstDay(mv_par05),lastday(mv_par05),mv_par01,,TRBA2->A2_COD,TRBA2->A2_LOJA,)
			
			If nVol > 0
				
				nQtdUs++
				
				@nLin,000 PSAY TRBA2->A2_COD
				@nLin,008 PSAY TRBA2->A2_LOJA
				@nLin,015 PSAY left(TRBA2->A2_NOME,29)
				@nLin,045 PSAY left(TRBA2->A2_L_FAZEN,19)
				@nLin,065 PSAY left(POSICIONE("CC2",1,XFILIAL("CC2")+TRBA2->A2_EST+TRBA2->A2_COD_MUN,"CC2_MUN"),14)
				@nLin,080 PSAY TRBA2->A2_CGC
				@nLin,095 PSAY TRBA2->A2_INSCR
				@nLin,110 PSAY TRBA2->A2_L_SIGSI
				@nLin,125 PSAY transform(nVol,"@E 999,999,999")
				nMedia := nVol/val(substr(dtos(lastday(mv_par05)),7,2))
				@nLin,140 PSAY transform(nMedia,"@E 999,999,999")
				nLin++
				
				nTotVol+=nVol
				nSubVol+=nVol
				
			EndIf
			
			If nLin > 55 // Salto de Pแgina. Neste caso o formulario tem 55 linhas...
				Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
				nLin := 8
			EndIf
			
			TRBA2->(dbskip())
		enddo
		DbCloseArea("TRBA2")
		
		@nLin,000 psay __PrtThinLine()
		nLin++
		@nLin,000 psay "Total de usuarios de Tanque:"+alltrim(str(nQtdUs))
		@nLin,125 PSAY transform(nSubVol,"@E 999,999,999")
		nMedia := nSubVol/val(substr(dtos(lastday(mv_par05)),7,2))
		@nLin,140 PSAY transform(nMedia,"@E 999,999,999")
		nLin++
		
		nQtdUs:=0
		
		nSubVol:=0
		
		// Salta de pagina
		Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
		nLin := 8
	Else	
		DbCloseArea("TRBA2")
	EndIf
	
	TMP->(dbSkip()) // Avanca o ponteiro do registro no arquivo
EndDo

TMP->(dbclosearea())

@nLin,000 psay __PrtThinLine()
nLin++
@nLin,000 psay "Total de Produtores:"+alltrim(str(nQtdTq))
@nLin,125 PSAY transform(nTotVol,"@E 999,999,999")
nMedia := nTotVol/val(substr(dtos(lastday(mv_par05)),7,2))
@nLin,140 PSAY transform(nMedia,"@E 999,999,999")
nLin++

//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณ Finaliza a execucao do relatorio...                                 ณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู

SET DEVICE TO SCREEN

//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณ Se impressao em disco, chama o gerenciador de impressao...          ณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู

If aReturn[5]==1
	dbCommitAll()
	SET PRINTER TO
	OurSpool(wnrel)
EndIf

MS_FLUSH()

Return

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบPrograma  ณRGLT031   บAutor  ณMicrosiga           บ Data ณ  01/05/10   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณ                                                            บฑฑ
ฑฑบ          ณ                                                            บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ                                                            บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
*/
Static Function ValidPerg()

Local aHelpPor := {}
Local aHelpSpa := {}
Local aHelpEng := {}

//Do Setor
aHelpPor := {}
Aadd( aHelpPor, 'Codigo do Setor        ')
U_xPutSx1(cPerg,"01","Setor   "," "," ","mv_ch1","C",6,0,0,"G",'U_ValSetPar()',"ZL2_01","","","mv_par01","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)

//Da Linha
aHelpPor := {}
Aadd( aHelpPor, 'Informe o codigo inicial do grupo   ')
Aadd( aHelpPor, 'que deseja filtrar.                 ')
U_xPutSx1(cPerg,"02","Da Linha"," "," ","mv_ch2","C",6,0,0,"G","","ZL3_01","","","mv_par02","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)

//Ate a Linha
aHelpPor := {}
Aadd( aHelpPor, 'Informe o codigo final do grupo   ')
Aadd( aHelpPor, 'que deseja filtrar.                 ')
U_xPutSx1(cPerg,"03","Ate a Linha"," "," ","mv_ch3","C",6,0,0,"G","","ZL3_01","","","mv_par03","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)

//Municipio
aHelpPor := {}
Aadd( aHelpPor, 'Informe o codigo do municipio')
Aadd( aHelpPor, 'para filtrar ou deixe em branco')
Aadd( aHelpPor, 'para nao filtrar')
//U_xPutSx1(cPerg,"05","Municipio"," "," ","mv_ch5","C",6,0,0,"G","","CC2","","","mv_par05","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)
U_xPutSx1(cPerg,"04","Municipio"," "," ","mv_ch4","C",6,0,0,"G","","CC2","","","mv_par04","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)

//Movimento
aHelpPor := {}
Aadd( aHelpPor, 'Informe o data final do mes')
Aadd( aHelpPor, 'ser considerado a entrega de leite')
U_xPutSx1(cPerg,"05","Data"," "," ","mv_ch5","D",10,0,0,"G","","","","","mv_par05","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)

//Quebra por municipio?
aHelpPor := {}
Aadd( aHelpPor, 'Deseja quebrar por municipio.  ')
U_xPutSx1(cPerg,"06","Queb.Municipio"," "," ","mv_ch6","N",1,0,0,"C","","","","","mv_par06","Sim","","","","Nao","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)

Return