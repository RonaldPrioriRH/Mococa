#Include "Protheus.ch"
#Include "Report.ch"
/*/

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ?
ฑฑษออออออออออัออออออออออหอออออออัอออออออออออออออออออออออหออออออออออออออออออัออออออออออออออออออออออออออออออออออออออออออออออออปฑ?
ฑฑบPrograma  ?RGLT015  ?Autor ?TOTVS                 ?Data da Criacao  ?09/12/2008                						บฑ?
ฑฑฬออออออออออุออออออออออสอออออออฯอออออออออออออออออออออออสออออออออออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออนฑ?
ฑฑบDescricao ?Resumo de Pagamento do produtor                          										            บฑ?
ฑฑ?         ?															                               						บฑ?
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑ?
ฑฑบUso       ?Lista os Produtores com seus eventos e respectivos valores totalizando o valor liquido a pagar.			    บฑ?
ฑฑ?         ?															                               						บฑ?
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑ?
ฑฑบParametros?Nenhum                     																			        บฑ?
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑ?
ฑฑบRetorno   ?Nenhum						  							                               						บฑ?
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑ?
ฑฑบUsuario   ?Totvs / Microsiga											                             					บฑ?
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑ?
ฑฑบSetor     ?Gestao do Leite                                                                          					บฑ?
ฑฑฬออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑ?
ฑฑ?           			          	ATUALIZACOES SOFRIDAS DESDE A CONSTRUCAO INICIAL                   						บฑ?
ฑฑฬออออออออออัออออออออออัออออออออออออออออออออออออออออออออออออออออออออออออออัออออออออออออออออออออออออออออออออออัอออออออออออออนฑ?
ฑฑบAutor     ?Data     ?Motivo da Alteracao  				               ณUsuario(Filial+Matricula+Nome)    ณSetor        บฑ?
ฑฑบฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤบฑ?
ฑฑ?         ?         ?                  							   ?                                 ? 	        บฑ?
ฑฑ?---------?---------?-------------------------------------------------?---------------------------------?------------บฑ?
ฑฑ?         ?         ?                   							   ?                                 ?			บฑ?
ฑฑ?---------?---------?-------------------------------------------------?---------------------------------?------------บฑ?
ฑฑศออออออออออฯออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออฯออออออออออออออออออออออออออออออออออฯอออออออออออออผฑ?
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ?
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿?
*/
User Function RGLT015()

Local cDesc1			:= "Este programa tem como objetivo imprimir relatorio "
Local cDesc2			:= "de acordo com os parametros informados pelo usuario."
Local cDesc3			:= "Resumo Pagamento Produtor"
Local cPict				:= ""
Local titulo			:= "Resumo Pagamento Produtor"
Local nLin				:= 80
Local Cabec1			:= " "
Local Cabec2			:= ""
Local imprime			:= .T.
Local aOrd				:= {}
Local cQuery1			:= ""
Local cQuery2			:= ""

Private aStruct			:= {}
Private lEnd			:= .F.
Private lAbortPrint		:= .F.
Private CbTxt			:= ""
Private limite			:= 220
Private tamanho			:= "G"
Private nomeprog		:= "RGLT015" // Coloque aqui o nome do programa para impressao no cabecalho
Private nTipo			:= 18
Private aReturn			:= { "Zebrado", 1, "Administracao", 2, 2, 1, "", 1}
Private nLastKey		:= 0
Private cbtxt			:= Space(10)
Private cbcont			:= 00
Private CONTFL			:= 01
Private m_pag			:= 01
Private wnrel			:= "RGLT015" // Coloque aqui o nome do arquivo usado para impressao em disco
Private cPerg			:= "RGLT015   "
Private cString			:= "ZLF"

validperg()
Pergunte(cPerg,.F.)

wnrel := SetPrint(cString,NomeProg,cPerg,@titulo,cDesc1,cDesc2,cDesc3,.T.,aOrd,.T.,Tamanho,,.T.)
If nLastKey == 27
	Return
EndIf
SetDefault(aReturn,cString)
If nLastKey == 27
	Return
EndIf
nTipo := If(aReturn[4]==1,15,18)
RptStatus({|| RunReport(Cabec1,Cabec2,Titulo,nLin) },Titulo)
Return

/*/
?
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ?
ฑฑษออออออออออัอออออออออออออหอออออออัอออออออออออออออออออออออหออออออออออออออออออัอออออออออออออออออออออออออออออออออออออออออออออปฑ?
ฑฑบPrograma  ?RUNREPORT   ?Autor ?Abrahao P. Santos     ?Data da Criacao  ?09/12/2008             						บฑ?
ฑฑฬออออออออออุอออออออออออออสอออออออฯอออออออออออออออออออออออสออออออออออออออออออฯอออออออออออออออออออออออออออออออออออออออออออออนฑ?
ฑฑบDescricao ?uncao auxiliar chamada pela RPTSTATUS. A funcao RPTSTATUS monta a janela com a regua de processamento.		บฑ?
ฑฑ?		 ?													                                   						บฑ?
ฑฑ?         ?															                               						บฑ?
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑ?
ฑฑบUso       ?	Programa principal										                               						บฑ?
ฑฑ?         ?															                               						บฑ?
ฑฑ?         ?															                               						บฑ?
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑ?
ฑฑบParametros?	Nenhum																										บฑ?
ฑฑ?		 ?											   					                       						บฑ?
ฑฑ?		 ?																											บฑ?
ฑฑ?		 ?													                                   						บฑ?
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑ?
ฑฑบRetorno   ?Nenhum						  							                               						บฑ?
ฑฑ?		 ?													                                   						บฑ?
ฑฑ?		 ?													                                   						บฑ?
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑ?
ฑฑบUsuario   ?Totvs / Microsiga											                             					บฑ?
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑ?
ฑฑบSetor     ?Gestao do Leite                                                                          					บฑ?
ฑฑฬออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑ?
ฑฑ?           			          	ATUALIZACOES SOFRIDAS DESDE A CONSTRUAO INICIAL                   						บฑ?
ฑฑฬออออออออออัออออออออออัออออออออออออออออออออออออออออออออออออออออออออออออออัออออออออออออออออออออออออออออออออออัอออออออออออออนฑ?
ฑฑบAutor     ?Data     ?Motivo da Alteracao  				               ณUsuario(Filial+Matricula+Nome)    ณSetor        บฑ?
ฑฑบฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤบฑ?
ฑฑ?         ?         ?                  							   ?                                 ? 	        บฑ?
ฑฑ?---------?---------?-------------------------------------------------?---------------------------------?------------บฑ?
ฑฑ?         ?         ?                   							   ?                                 ?			บฑ?
ฑฑ?---------?---------?-------------------------------------------------?---------------------------------?------------บฑ?
ฑฑศออออออออออฯออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออฯออออออออออออออออออออออออออออออออออฯอออออออออออออผฑ?
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ?
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿?
/*/
Static Function RunReport(Cabec1,Cabec2,Titulo,nLin)

Local nOrdem   := 0
Local nTotDeb  := 0
Local nTotCre  := 0
Local nTotVol  := 0
Local nLiq     := 0
Local VlrPrd   := 0
Local nMaxLin  := 60 // maximo de linhas
Local cUltFret := ""
Local cUltLin  := ""
Local nqtdregs := 0
Local nTotDeb  := 0
Local nTotCre  := 0
Local nPreco   := 0
Local nVolume  := 0
Local agrupa   := Iif(mv_par14==1,.T.,.F.)
Local lProdutor:= Iif(mv_par15==1,lProdutor:=.T.,lProdutor:=.F.)

Static nIniPos := 50
Static nMaxCol := 11 // maximo de colunas
Static nTamCmp := 11

Private nOutros    := 0
Private dt1,dt2    := CTOD("")
Private nSubVolume := 0
Private aSubtotal  := {}
Private aLin       := {}

// posiciona no Mix pra pegar datas
dbSelectArea("ZLE")
dbSetOrder(1)
dbseek(xfilial("ZLE")+mv_par02)

dt1:=ZLE->ZLE_DTINI
dt2:=ZLE->ZLE_DTFIM
dbCloseArea("ZLE")

Cabec1 := "Setor: "+mv_par01+" Mix: "+mv_par02

nLin := nMaxLin

// obtem campos dinamicos (eventos)
aStruct := getStruct(mv_par01,mv_par02,agrupa)

// Monta cabecalho
// com os campos dinamicos (eventos)
Cabec2:=padr("CODIGO LOJA PRODUTOR",29)
Cabec2+=space(3)+"VOLUME"
Cabec2+=space(5)+"PRECO"
For i:=1 to len(aStruct)
	If i<=nMaxCol
		Cabec2 += strSpace(aStruct[i,2],nTamCmp)
	EndIf
	If i==len(aStruct) .and. i>nMaxCol
		Cabec2 += strSpace("OUTROS",nTamCmp)
	EndIf
	aAdd(aSubTotal,0) // subtotal das linhas
Next i
Cabec2+=strSpace("VLR LIQUIDO",12)


// leia linhas
cQuery1 := " SELECT ZLD_LINROT,ZLD_RETIRO,ZLD_RETILJ, ZLD_GRPRC "
cQuery1 += " FROM " + RetSqlName("ZLD") + " ZLD "
cQuery1 += " WHERE D_E_L_E_T_ = ' ' "
cQuery1 += " AND ZLD.ZLD_FILIAL = '" + XFILIAL("ZLD") + "' "
cQuery1 += " AND ZLD.ZLD_SETOR = '" + AllTrim(MV_PAR01) + "' "
cQuery1 += " AND ZLD.ZLD_DTCOLE BETWEEN '" + dtos(dt1) + "' AND '"+ dtos(dt2) +"' "
cQuery1 += " AND ZLD.ZLD_FRETIS BETWEEN '" + MV_PAR04 + "' AND '"+MV_PAR06+"' "
cQuery1 += " AND ZLD.ZLD_LJFRET BETWEEN '" + MV_PAR05 + "' AND '"+MV_PAR07+"' "
cQuery1 += " AND ZLD.ZLD_RETIRO BETWEEN '" + MV_PAR08 + "' AND '"+MV_PAR10+"' "
cQuery1 += " AND ZLD.ZLD_RETILJ BETWEEN '" + MV_PAR09 + "' AND '"+MV_PAR11+"' "
cQuery1 += " AND ZLD.ZLD_LINROT BETWEEN '" + MV_PAR12 + "' AND '"+MV_PAR13+"' "
cQuery1 += " AND ZLD.ZLD_RETIRO != ' ' "
cQuery1 += " GROUP BY ZLD_LINROT,ZLD_RETIRO,ZLD_RETILJ, ZLD_GRPRC "
cQuery1 += " ORDER BY ZLD_LINROT,ZLD_RETIRO,ZLD_RETILJ, ZLD_GRPRC "

If Select("TRL") > 0
	dbSelectArea("TRL")
	dbCloseArea("TRL")
EndIf
dbUseArea( .T., "TOPCONN", TcGenQry(,,cQuery1), "TRL", .T., .F. )

COUNT TO nqtdregs
setRegua(nqtdregs)

TRL->(dbGoTop())

While TRL->(!Eof())
	
	incregua()
	
	If nLin >= nMaxLin
		Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
		nLin := 9
	EndIf
	
	// MOSTRA CABECALHO (LINHA E FRETISTA)
	If cUltLin != TRL->ZLD_LINROT
		
		// Mostra subtotal da linha
		If cUltLin != "" .And. mv_par16 == 2//imprime positivo e negativo
			nLin := showSubTotal(nLin)
			nSubVolume:=0
		EndIf
		
		// POSICIONA NA LINHA
		dbSelectArea("ZLW")
		dbSetOrder(1)
		dbGoTop()
		dbSeek(XFILIAL("ZLW")+TRL->ZLD_LINROT)
		
		@nLin,000 PSAY "Linha: "+TRL->ZLD_LINROT+"-"+ZLW->ZLW_DESCRI+"    Fretista: "+POSICIONE("SA2",1,XFILIAL("SA2")+ZLW->ZLW_FRETIS+ZLW->ZLW_FRETLJ,"A2_NOME")
		nLin++
		
		dbCloseArea("ZLW")
		dbSelectArea("TRL")
		
	EndIf
	cUltLin := TRL->ZLD_LINROT
	
	// Obtem valores dos eventos do produtor corrente
	// e ja calcula valor liquido
	// Utiliza o array aLin para armazenar os valores de cada evento
	// para nao precisar buscar esses valores novamente
	aLin := {}
	For i:=1 to len(aStruct)
		If agrupa
			nVlrPrd := u_getTotGp(xfilial("ZLD"),aStruct[i,1],mv_par01,TRL->ZLD_GRPRC,ZLD_RETIRO,ZLD_RETILJ,MV_PAR02,"",mv_par03,"L")
		Else
			nVlrPrd := u_getTotEv(xfilial("ZLD"),aStruct[i,1],mv_par01,TRL->ZLD_GRPRC,ZLD_RETIRO,ZLD_RETILJ,MV_PAR02,mv_par03,"L")
		EndIf
		// Armazena total geral
		aStruct[i,3] += nVlrPrd
		
		// Armazena subtotal
		aSubTotal[i] += nVlrPrd
		
		aAdd(aLin,nVlrPrd)
		nLiq+=nVlrPrd
	Next i
	
	If lProdutor//Mostra os produtores linha a linha
		If mv_par16 == 1//somente negativos
			If nLiq < 0 //valor liquido menor que zero
				
				// MOSTRA PRODUTOR E SEUS RESPECTIVOS VALORES
				@nLin,000 PSAY TRL->ZLD_RETIRO + "-" +TRL->ZLD_RETILJ + " "+LEFT(POSICIONE("SA2",1,XFILIAL("SA2")+TRL->ZLD_RETIRO+TRL->ZLD_RETILJ,"A2_NOME"),15)
				
				// Obtem volume do produtor
				nVolume := U_VolLeite(xfilial("ZLD"),dt1,dt2,mv_par01,TRL->ZLD_GRPRC,TRL->ZLD_RETIRO,TRL->ZLD_RETILJ,"")
				
				// armazena volume para o subtotal
				nSubVolume += nVolume
				@nLin,030 PSAY nVolume Picture "@E 9,999,999"
				
				// Mostra o preco do leite
				nPreco := u_getTotCr(xfilial("ZLD"),mv_par01,TRL->ZLD_GRPRC,TRL->ZLD_RETIRO,TRL->ZLD_RETILJ,mv_par02,mv_par03)
				nPreco := nPreco/nVolume
				@nLin,040 PSAY nPreco Picture "@E 9999.9999"
				
				nPos1:=nIniPos
				For i:=1 to len(aStruct)
					nVlrPrd := aLin[i]
					If i<=nMaxCol
						@nLin,nPos1 PSAY nVlrPrd Picture "@E 99,999.99"
						nPos1 += nTamCmp
					Else
						nOutros += nVlrPrd
					EndIf
					If i==len(aStruct) //.and. nOutros <> 0
						@nLin,nPos1 PSAY nOutros Picture "@E 99,999.99"
						nPos1 += nTamCmp
					EndIf
				Next i
				
				// MOSTRA VLR LIQUIDO
				@nLin,nPos1 PSAY nLiq Picture "@E 99,999,999.99"
				
				nLin++
				nOutros:=0
			EndIf
		
		Else//NAO (imprime todos, negativos e positivos)
		
			// MOSTRA PRODUTOR E SEUS RESPECTIVOS VALORES
			@nLin,000 PSAY TRL->ZLD_RETIRO + "-" +TRL->ZLD_RETILJ + " "+LEFT(POSICIONE("SA2",1,XFILIAL("SA2")+TRL->ZLD_RETIRO+TRL->ZLD_RETILJ,"A2_NOME"),15)
			
			// Obtem volume do produtor
			nVolume := U_VolLeite(xfilial("ZLD"),dt1,dt2,mv_par01,TRL->ZLD_GRPRC,TRL->ZLD_RETIRO,TRL->ZLD_RETILJ,"")
			
			// armazena volume para o subtotal
			nSubVolume += nVolume
			@nLin,030 PSAY nVolume Picture "@E 9,999,999"
			
			// Mostra o preco do leite
			nPreco := u_getTotCr(xfilial("ZLD"),mv_par01,TRL->ZLD_GRPRC,TRL->ZLD_RETIRO,TRL->ZLD_RETILJ,mv_par02,mv_par03)
			nPreco := nPreco/nVolume
			@nLin,040 PSAY nPreco Picture "@E 99.9999"
			
			nPos1:=nIniPos
			For i:=1 to len(aStruct)
				nVlrPrd := aLin[i]
				If i<=nMaxCol
					@nLin,nPos1 PSAY nVlrPrd Picture "@E 999,999.99"
					nPos1 += nTamCmp
				Else
					nOutros += nVlrPrd
				EndIf
				If i==len(aStruct) .and. nOutros <> 0
					@nLin,nPos1 PSAY nOutros Picture "@E 999,999.99"
					nPos1 += nTamCmp
				EndIf
			Next i
			
			// MOSTRA VLR LIQUIDO
			@nLin,nPos1 PSAY nLiq Picture "@E 99,999,999.99"
			
			nLin++
			nOutros:=0
		EndIf
	EndIf
	
	nLiq:=0
	nOutros:=0
	
	TRL->(dbSkip())
EndDo
TRL->(dbCloseArea())

// -----------------------------------
// Mostra SubTotal da ultima linha
// -----------------------------------
If mv_par16 == 2//imprime positivo e negativo
	nLin := showSubTotal(nLin)
EndIf

//---------------------------------------------------
// Se nao mostra os Produtores linha a linha
//---------------------------------------------------
If !lProdutor .And. mv_par16 == 2//imprime positivo e negativo
	
	Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
	nLin := 9
	
	@nLin,000 PSAY "Resumo Geral"
	nLin += 2
	
	@nLin,000 PSAY "Codigo"
	@nLin,008 PSAY "Evento"
	@nLin,030 PSAY "Creditos"
	@nLin,050 PSAY "Debitos"
	nLin++
	
	@nLin,000 PSAY Replicate("-",60)
	nLin++
	For i:=1 to len(aStruct)
		@nLin,000 PSAY aStruct[i,1]
		@nLin,008 PSAY aStruct[i,2]
		If aStruct[i,3] >= 0
			@nLin,020 PSAY aStruct[i,3] Picture "@E 999,999,999,999.99"
			nTotCre+=aStruct[i,3]
		Else
			@nLin,040 PSAY aStruct[i,3] Picture "@E 999,999,999,999.99"
			nTotDeb+=aStruct[i,3]
		EndIf
		nLin++
	Next i
	@nLin,000 PSAY Replicate("-",60)
	nLin++
	@nLin,000 PSAY "Total"
	@nLin,020 PSAY nTotCre Picture "@E 999,999,999,999.99"
	@nLin,040 PSAY nTotDeb Picture "@E 999,999,999,999.99"
	nLin++
	@nLin,000 PSAY "Valor Liquido"
	If (nTotcre+ntotDeb) >= 0
		@nLin,020 PSAY (nTotcre+ntotDeb) Picture "@E 999,999,999,999.99"
	Else
		@nLin,040 PSAY (nTotcre+ntotDeb) Picture "@E 999,999,999,999.99"
	EndIf
	nLin++
	
	@ nLin,000 PSay __PrtThinLine()
	nLin++
	
EndIf

SET DEVICE TO SCREEN
If aReturn[5]==1
	dbCommitAll()
	SET PRINTER TO
	OurSpool(wnrel)
EndIf

MS_FLUSH()
Return

/*
?
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ?
ฑฑษออออออออออัอออออออออออออหอออออออัอออออออออออออออออออออออหออออออออออออออออออัอออออออออออออออออออออออออออออออออออออออออออออปฑ?
ฑฑบPrograma  ?getStruct   ?Autor ?Abrahao P. Santos     ?Data da Criacao  ?09/12/2008             						บฑ?
ฑฑฬออออออออออุอออออออออออออสอออออออฯอออออออออออออออออออออออสออออออออออออออออออฯอออออออออออออออออออออออออออออออออออออออออออออนฑ?
ฑฑบDescricao ?Retorna campos dinamicos que estao na ZLF                                               						บฑ?
ฑฑ?		 ?													                                   						บฑ?
ฑฑ?         ?															                               						บฑ?
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑ?
ฑฑบUso       ?															                               						บฑ?
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑ?
ฑฑบParametros?	Nenhum																										บฑ?
ฑฑ?		 ?											   					                       						บฑ?
ฑฑ?		 ?																											บฑ?
ฑฑ?		 ?													                                   						บฑ?
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑ?
ฑฑบRetorno   ?Nenhum						  							                               						บฑ?
ฑฑ?		 ?													                                   						บฑ?
ฑฑ?		 ?													                                   						บฑ?
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑ?
ฑฑบUsuario   ?Totvs / Microsiga											                             					บฑ?
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑ?
ฑฑบSetor     ?Gestao do Leite                                                                          					บฑ?
ฑฑฬออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑ?
ฑฑ?           			          	ATUALIZACOES SOFRIDAS DESDE A CONSTRUAO INICIAL                   						บฑ?
ฑฑฬออออออออออัออออออออออัออออออออออออออออออออออออออออออออออออออออออออออออออัออออออออออออออออออออออออออออออออออัอออออออออออออนฑ?
ฑฑบAutor     ?Data     ?Motivo da Alteracao  				               ณUsuario(Filial+Matricula+Nome)    ณSetor        บฑ?
ฑฑบฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤบฑ?
ฑฑ?         ?         ?                  							   ?                                 ? 	        บฑ?
ฑฑ?---------?---------?-------------------------------------------------?---------------------------------?------------บฑ?
ฑฑ?         ?         ?                   							   ?                                 ?			บฑ?
ฑฑ?---------?---------?-------------------------------------------------?---------------------------------?------------บฑ?
ฑฑศออออออออออฯออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออฯออออออออออออออออออออออออออออออออออฯอออออออออออออผฑ?
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ?
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿?
*/
Static Function getStruct(cpSetor,cpMix,cpAgrupa)

Local aArea := GetArea()
Local aCampos := {}

If cpAgrupa
	dbSelectArea("ZL7")
	dbSetOrder(1)
	dbGoTop()
	While !Eof()
		aAdd(aCampos,{ZL7->ZL7_COD,LEFT(ZL7->ZL7_NREDUZ,8),0})
		dbSkip()
	EndDo
	dbCloseArea("ZL7")
EndIf

If !cpAgrupa
	cQuery1 := " SELECT ZLF_EVENTO AS CODIGO,MAX(ZLF_DEBCRE) AS DEBCRE "
	cQuery1 += " FROM " + RetSqlName("ZLF") + " ZLF "
	cQuery1 += " WHERE ZLF.ZLF_FILIAL = '"+xFilial("ZLF")+" ' "
	cQuery1 += " AND ZLF.ZLF_SETOR = '" + AllTrim(cpSetor) + "' "
	cQuery1 += " AND ZLF.ZLF_CODZLE = '" + AllTrim(cpMix) + "' "
	cQuery1 += " AND ZLF.ZLF_TP_MIX = 'L' AND ZLF.D_E_L_E_T_ = ' ' ""
	cQuery1 += " GROUP BY ZLF_EVENTO ORDER BY ZLF_EVENTO "
	If Select("TRB") > 0
		dbSelectArea("TRB")
		dbCloseArea("TRB")
	EndIf
	dbUseArea( .T., "TOPCONN", TcGenQry(,,cQuery1), "TRB", .T., .F. )
	While !TRB->(Eof())
		aAdd(aCampos,{TRB->CODIGO,POSICIONE("ZL8",1,XFILIAL("ZL8")+TRB->CODIGO,"ZL8_NREDUZ"),0})
		TRB->(dbSkip())
	EndDo
	TRB->(dbCloseArea())
EndIf

RestArea(aArea)
Return aCampos

/*
?
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ?
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑ?
ฑฑบPrograma  ?RGLT015  ?Autor ?Microsiga          ?Data ? 00/00/00   บฑ?
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑ?
ฑฑบDesc.     ?                                                           บฑ?
ฑฑ?         ?                                                           บฑ?
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑ?
ฑฑบUso       ?                                                           บฑ?
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑ?
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ?
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿?
*/
Static Function strSpace(cTexto,nQtd)
cTexto := space(nQtd-len(alltrim(cTexto)))+alltrim(cTexto)
Return cTexto

/*
?
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ?
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑ?
ฑฑบPrograma  ?RGLT015  ?Autor ?Microsiga          ?Data ? 00/00/00   บฑ?
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑ?
ฑฑบDesc.     ?                                                           บฑ?
ฑฑ?         ?                                                           บฑ?
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑ?
ฑฑบUso       ?                                                           บฑ?
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑ?
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ?
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿?
*/
Static Function showSubTotal(nLin)

Local nSubLiq := 0

@nLin,000 PSAY "SubTotal -------->"
@nLin,030 PSAY nSubVolume Picture "@E 99,999,999"
nOutros:= 0
nPos1:=nIniPos
For i:=1 to len(aStruct)
	nVlrPrd := aSubTotal[i]
	aSubTotal[i] := 0
	nSubLiq+=nVlrPrd
	If i<=nMaxCol
		@nLin,nPos1 PSAY nVlrPrd Picture "@E 999,999.99"
		nPos1 += nTamCmp
	Else
		nOutros += nVlrPrd
	EndIf
	If i==len(aStruct) //.and. nOutros <> 0
		@nLin,nPos1 PSAY nOutros Picture "@E 999,999.99"
		nPos1 += nTamCmp
	EndIf
Next i

For u:=1 to len(aSubTotal)
	aSubTotal[u] := 0
Next u

// MOSTRA VLR LIQUIDO
@nLin,nPos1 PSAY nSubLiq Picture "@E 99,999,999.99"
nLin++

@ nLin,000 PSay __PrtThinLine()
nLin++

nOutros:=0

Return nLin

/*
?
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ?
ฑฑษออออออออออัอออออออออออออหอออออออัอออออออออออออออออออออออหออออออออออออออออออัอออออออออออออออออออออออออออออออออออออออออออออปฑ?
ฑฑบPrograma  ?ValidPerg   ?Autor ?Abrahao P. Santos     ?Data da Criacao  ?09/12/2008             						บฑ?
ฑฑฬออออออออออุอออออออออออออสอออออออฯอออออออออออออออออออออออสออออออออออออออออออฯอออออออออออออออออออออออออออออออออออออออออออออนฑ?
ฑฑบDescricao ?Funcao estatica que cria as perguntas/parametros da tabela SX1.                         						บฑ?
ฑฑ?		 ?													                                   						บฑ?
ฑฑ?         ?															                               						บฑ?
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑ?
ฑฑบUso       ?	SX1 - Tabela de Parametros								                               						บฑ?
ฑฑ?         ?															                               						บฑ?
ฑฑ?         ?															                               						บฑ?
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑ?
ฑฑบParametros?	Nenhum																										บฑ?
ฑฑ?		 ?											   					                       						บฑ?
ฑฑ?		 ?																											บฑ?
ฑฑ?		 ?													                                   						บฑ?
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑ?
ฑฑบRetorno   ?Nenhum						  							                               						บฑ?
ฑฑ?		 ?													                                   						บฑ?
ฑฑ?		 ?													                                   						บฑ?
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑ?
ฑฑบUsuario   ?Totvs / Microsiga											                             					บฑ?
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑ?
ฑฑบSetor     ?Gestao do Leite                                                                          					บฑ?
ฑฑฬออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑ?
ฑฑ?           			          	ATUALIZACOES SOFRIDAS DESDE A CONSTRUAO INICIAL                   						บฑ?
ฑฑฬออออออออออัออออออออออัออออออออออออออออออออออออออออออออออออออออออออออออออัออออออออออออออออออออออออออออออออออัอออออออออออออนฑ?
ฑฑบAutor     ?Data     ?Motivo da Alteracao  				               ณUsuario(Filial+Matricula+Nome)    ณSetor        บฑ?
ฑฑบฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤบฑ?
ฑฑ?         ?         ?                  							   ?                                 ? 	        บฑ?
ฑฑ?---------?---------?-------------------------------------------------?---------------------------------?------------บฑ?
ฑฑ?         ?         ?                   							   ?                                 ?			บฑ?
ฑฑ?---------?---------?-------------------------------------------------?---------------------------------?------------บฑ?
ฑฑศออออออออออฯออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออฯออออออออออออออออออออออออออออออออออฯอออออออออออออผฑ?
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ?
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿?
*/
Static Function ValidPerg()

Local aHelpPor := {}
Local aHelpSpa := {}
Local aHelpEng := {}

//Do Setor
aHelpPor := {}
Aadd( aHelpPor, 'Informe o codigo do Setor')
Aadd( aHelpPor, 'que deseja filtrar.                 ')
U_xPutSx1(cPerg,"01","Setor   "," "," ","mv_ch1","C",6,0,0,"G",'U_ValSetPar()',"ZL2_01","","","mv_par01","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)

//Do Mix
aHelpPor := {}
Aadd( aHelpPor, 'Informe o codigo do Mix  ')
Aadd( aHelpPor, 'que deseja filtrar.                 ')
U_xPutSx1(cPerg,"02","Mix     "," "," ","mv_ch2","C",6,0,0,"G","","ZLE_01","","","mv_par02","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)

//Versao
aHelpPor := {}
Aadd( aHelpPor, 'Informe a Versao do Mix  ')
Aadd( aHelpPor, 'que deseja filtrar.                 ')
U_xPutSx1(cPerg,"03","Versao  "," "," ","mv_ch3","C",1,0,0,"G","","","","","mv_par03","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)


//Do Fretista
aHelpPor := {}
Aadd( aHelpPor, 'Informe o codigo inicial do Fretista  ')
Aadd( aHelpPor, 'que deseja filtrar.                 ')
U_xPutSx1(cPerg,"04","Do Fretista"," "," ","mv_ch4","C",6,0,0,"G","","SA2_L3","","","mv_par04","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)

//Da Loja
aHelpPor := {}
Aadd( aHelpPor, 'Informe o codigo inicial da Loja  ')
Aadd( aHelpPor, 'do fretista que deseja filtrar.   ')
U_xPutSx1(cPerg,"05","Da Loja   "," "," ","mv_ch5","C",2,0,0,"G","","","","","mv_par05","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)

//Ao Fretista
aHelpPor := {}
Aadd( aHelpPor, 'Informe o codigo final do Fretista  ')
Aadd( aHelpPor, 'que deseja filtrar.                 ')
U_xPutSx1(cPerg,"06","Ao Fretista"," "," ","mv_ch6","C",6,0,0,"G","","SA2_L3","","","mv_par06","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)

//Ate Loja
aHelpPor := {}
Aadd( aHelpPor, 'Informe o codigo final   da Loja  ')
Aadd( aHelpPor, 'do fretista que deseja filtrar.   ')
U_xPutSx1(cPerg,"07","Ate a Loja "," "," ","mv_ch7","C",2,0,0,"G","","","","","mv_par07","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)

//Do Produtor
aHelpPor := {}
Aadd( aHelpPor, 'Informe o codigo inicial do Produtor')
Aadd( aHelpPor, 'que deseja filtrar.                 ')
U_xPutSx1(cPerg,"08","Do Produtor"," "," ","mv_ch8","C",6,0,0,"G","","SA2_L9","","","mv_par08","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)

//Da Loja
aHelpPor := {}
Aadd( aHelpPor, 'Informe o codigo inicial da Loja  ')
Aadd( aHelpPor, 'do produtor que deseja filtrar.   ')
U_xPutSx1(cPerg,"09","Da Loja   "," "," ","mv_ch9","C",2,0,0,"G","","","","","mv_par09","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)

//Ao Produtor
aHelpPor := {}
Aadd( aHelpPor, 'Informe o codigo final do Produtor')
Aadd( aHelpPor, 'que deseja filtrar.                 ')
U_xPutSx1(cPerg,"10","Ao Produtor"," "," ","mv_ch10","C",6,0,0,"G","","SA2_L9","","","mv_par10","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)

//Ate a Loja
aHelpPor := {}
Aadd( aHelpPor, 'Informe o codigo final da Loja  ')
Aadd( aHelpPor, 'do produtor que deseja filtrar.   ')
U_xPutSx1(cPerg,"11","Ate a Loja  "," "," ","mv_ch11","C",2,0,0,"G","","","","","mv_par11","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)

//Da Linha
aHelpPor := {}
Aadd( aHelpPor, 'Informe o codigo inicial da linha  ')
Aadd( aHelpPor, 'que deseja filtrar.   ')
U_xPutSx1(cPerg,"12","Da Linha  "," "," ","mv_ch12","C",6,0,0,"G","","ZLW_01","","","mv_par12","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)

//Ate a Linha
aHelpPor := {}
Aadd( aHelpPor, 'Informe o codigo final da linha  ')
Aadd( aHelpPor, 'que deseja filtrar.   ')
U_xPutSx1(cPerg,"13","Ate a Linha"," "," ","mv_ch13","C",6,0,0,"G","","ZLW_01","","","mv_par13","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)

//Agrupa
aHelpPor := {}
Aadd( aHelpPor, 'Deseja agrupar os eventos?  ')
Aadd( aHelpPor, 'Influencia na quantidade de ')
Aadd( aHelpPor, 'colunas que serao impressas.')
U_xPutSx1(cPerg,"14","Agrupar"," "," ","mv_ch14","N",1,0,0,"C","","","","","mv_par14","Sim","Sim","Sim","","Nao","Nao","Nao","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)

//Lista produtores
aHelpPor := {}
Aadd( aHelpPor, 'Lista os produtores em cada ')
Aadd( aHelpPor, 'Rota/Linha do tranportador. ')
U_xPutSx1(cPerg,"15","Imprime Produtores ?"," "," ","mv_ch15","N",1,0,0,"C","","","","","mv_par15","Sim","Sim","Sim","","Nao","Nao","Nao","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)

//Lista produtores
aHelpPor := {}
Aadd( aHelpPor, 'Imprime somente de produtor ')
Aadd( aHelpPor, 'que o saldo ficou negativo. ')
U_xPutSx1(cPerg,"16","Imprime so Negativos ?"," "," ","mv_ch16","N",1,0,0,"C","","","","","mv_par16","Sim","Sim","Sim","","Nao","Nao","Nao","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)

Return