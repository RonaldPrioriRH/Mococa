#INCLUDE "PROTHEUS.ch"
#INCLUDE "TOPCONN.ch"
#INCLUDE "RWMAKE.ch"
/*/

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัอออออออออออออออออออออออหออออออออออออออออออัออออออออออออออออออออออออออออออออออออออออออออออออปฑฑ
ฑฑบPrograma  ณ RGLT021  บ Autor ณ TOTVS                 บ Data da Criacao  ณ 27/01/2009                						บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯอออออออออออออออออออออออสออออออออออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบDescricao ณ   Relacao Rota/Linha	      						    		                          						บฑฑ
ฑฑบ          ณ 															                               						บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ                                          															  		บฑฑ
ฑฑบ          ณ 															                               						บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบParametrosณ Nenhum						   							                               						บฑฑ
ฑฑบ			 ณ														                                   						บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบRetorno   ณ Nenhum													                               						บฑฑ
ฑฑบ			 ณ														                                   						บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUsuario   ณ															                             						บฑฑ
ฑฑฬออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบSetor     ณ Gestao do Leite                                                                      						บฑฑ
ฑฑฬออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบ            						ATUALIZACOES SOFRIDAS DESDE A CONSTRUAO INICIAL                   						บฑฑ
ฑฑฬออออออออออัออออออออออัออออออออออออออออออออออออออออออออออออออออออออออออออัออออออออออออออออออออออออออออออออออัอออออออออออออนฑฑ
ฑฑบAutor     ณ Data     ณ Motivo da Alteracao  				               ณUsuario(Filial+Matricula+Nome)    ณSetor        บฑฑ
ฑฑฬฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤนฑฑ
ฑฑบ          ณ          ณ                    							   ณ                                  ณ 			บฑฑ
ฑฑศออออออออออฯออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออฯออออออออออออออออออออออออออออออออออฯอออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
/*/
User Function RGLT021

Local cDesc1         := "Este programa tem como objetivo imprimir relatorio "
Local cDesc2         := "de acordo com os parametros informados pelo usuario."
Local cDesc3         := ""
Local cPict          := ""
Local titulo         := "Cont.Rot/Lin"
Local nFret          := ""
Local nLr            := ""
Local nTra           := ""
Local nProd          := ""
Local Cabec1         := ""
Local Cabec2         := "CODIGO     PRODUTOR              VOLUME   MED/DIA FAZENDA       MUNICIPIO"
Local cQuery         := ""
Local nR_L           := ""
Local nvei           := ""
Local motor          := ""
Local nLr1           := ""
Local nFaz           := ""
Local imprime        := .T.
Local aOrd           := {}
Local nLin           := 80
Local n_tot1         := 0
Local n_tot2         := 0
Local n_tot3         := 0
Local nmedia         := 0
Local ndias          := 0
Local ncontap        := 0
Local nvolume        := 0
Local nvoldia        := 0
Local ttkm           := 0
Local ttc            := 0
Local nvoldia        := 0
Local tkm            := 0
Local ncontap        := 0
Local tar            := 0
Local nvol2          := 0

Private lEnd         := .F.
Private lAbortPrint  := .F.
Private cbtxt        := Space(10)
Private wnrel        := "Cont.RotLin" // Coloque aqui o nome do arquivo usado para impressao em disco
Private cPerg        := "RGLT021   "
Private cString      := "ZLD"
Private CbTxt        := ""
Private tamanho      := "M"
Private nomeprog     := "RGLT021" // Coloque aqui o nome do programa para impressao no cabecalho
Private aReturn      := { "Zebrado", 1, "Administracao", 2, 2, 1, "", 1}
Private nLastKey     := 0
Private nTipo        := 18
Private limite       := 132
Private cbcont       := 00
Private CONTFL       := 01
Private m_pag        := 01

dbSelectArea("ZLD")
dbSetOrder(1)

ValidPerg()
Pergunte(cPerg,.F.)

wnrel := SetPrint(cString,NomeProg,cPerg,@titulo,cDesc1,cDesc2,cDesc3,.T.,aOrd,.T.,Tamanho,,.T.)

If nLastKey == 27
	Return
EndIf

SetDefault(aReturn,cString)

If nLastKey == 27
	Return
EndIf

nTipo := If(aReturn[4]==1,15,18)

RptStatus({|| RunReport(Cabec1,Cabec2,Titulo,nLin) },Titulo)

Return

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบPrograma  ณRGLT021   บAutor  ณMicrosiga           บ Data ณ  09/09/10   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณ                                                            บฑฑ
ฑฑบ          ณ                                                            บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ                                                            บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
*/
Static Function RunReport(Cabec1,Cabec2,Titulo,nLin)

Local nOrdem
Local nAux     := 0
Local dtini    := MV_PAR04
Local dtfim    := MV_PAR05
Local dtAtual  := dtini
Local TotGeral := 0

Private nTarifa:=0
Private nQtdDias:=0
Private nVol:=0
Private nQtdPrd := 0
Private cUltLin := ""

cUltLin:=""

While dtAtual <= dtfim
	dtAtual++
	nQtdDias++
EndDo

Cabec1:="PERIODO DE "+dtoc(dtini)+" A "+dtoc(dtfim)

dbSelectArea(cString)
dbSetOrder(1)

cQuery := "SELECT ZLD_SETOR,ZLD_LINROT,ZLD_RETIRO,ZLD_RETILJ,SUM(ZLD_QTDBOM) AS VOLUME FROM " + RetSqlName("ZLD") + " ZLD "
cQuery += " WHERE D_E_L_E_T_ = ' '"
cQuery += " AND ZLD_FILIAL = '"+xFILIAL("ZLD")+"'"
cQuery += " AND ZLD_DTCOLE BETWEEN  '" + DTOS(MV_PAR04) + "' AND '" + DTOS(MV_PAR05) + "'"
cQuery += " AND ZLD_LINROT BETWEEN  '" + MV_PAR02 + "' AND '" + MV_PAR03 + "'"
If !Empty(MV_PAR01)
	cQuery += " AND ZLD_SETOR = '" + MV_PAR01 +"'"
EndIf
cQuery += " GROUP BY ZLD_SETOR,ZLD_LINROT,ZLD_RETIRO,ZLD_RETILJ"
cQuery += " ORDER BY ZLD_SETOR,ZLD_LINROT,ZLD_RETIRO,ZLD_RETILJ"

If Select("TRF") <> 0
	TRF->(dbCloseArea("TRF"))
EndIf

dbUseArea( .T., "TOPCONN", TcGenQry(,,cQuery), "TRF", .T., .F. )

Count to nAux

SetRegua(nAux)

TRF->(dbGoTop())

nLin:=0
while !TRF->(eof())
	
	If lAbortPrint
		@nLin,00 PSAY "*** CANCELADO PELO OPERADOR ***"
		Exit
	EndIf
	
	IncProc()
	
	If nLin > 55
		Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
		nLin:=9
	EndIf
	
	If cUltLin <> TRF->ZLD_LINROT
		
		If cUltLin != ""
			nLin:=SubTotal(nLin,dtini,dtfim)
		EndIf
		
		Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
		nLin:=9
		
		// Cabecalho
		nLin:=ShowCabec(nLin)
		
	EndIf
	cUltLin:=TRF->ZLD_LINROT
	
	dbSelectArea("SA2")
	dbSetOrder(1)
	dbSeek(xFILIAL("SA2")+TRF->ZLD_RETIRO+TRF->ZLD_RETILJ)
	
	@nLin,000 PSAY TRF->ZLD_RETIRO
	@nLin,007 PSAY TRF->ZLD_RETILJ
	@nLin,012 PSAY LEFT( A2_NOME , 15 )
	@nLin,028 PSAY TransForm(TRF->VOLUME,"@E 999,999,999")
	@nLin,040 PSAY TransForm((TRF->VOLUME/nQtdDias),"@E 9,999,999")
	@nLin,050 PSAY LEFT( A2_L_FAZEN , 13 )
	@nLin,065 PSAY LEFT( POSICIONE("CC2",1,xFILIAL("CC2")+A2_EST+A2_COD_MUN,"CC2_MUN") , 13 )
	nLin++
	
	TotGeral += TRF->VOLUME
	nVol     += TRF->VOLUME
	nQtdPrd++
	
	dbSelectArea("TRF")
	TRF->(dbSkip())
EndDo

SET DEVICE TO SCREEN

If nAux > 0
	nLin:=SubTotal(nLin,dtini,dtfim)
EndIf

//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณ Imprime o total geral. ณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
If nLin > 55
	Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
	nLin:=9
EndIf

@nLin,000 PSAY "TOTAL GERAL VOLUME:"
@nLin,026 PSAY TransForm(TotGeral,"@E 9,999,999,999")
nLin++
@nLin,000 PSAY __PrtThinLine()

//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณ FIM DA IMPRESSAO.      ณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
If aReturn[5]==1
	dbCommitAll()
	SET PRINTER TO
	OurSpool(wnrel)
EndIf

MS_FLUSH()

Return

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบPrograma  ณRGLT021   บAutor  ณMicrosiga           บ Data ณ  09/09/10   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณ                                                            บฑฑ
ฑฑบ          ณ                                                            บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ                                                            บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
*/
Static Function validPerg()

Local aHelpPor := {}
Local aHelpSpa := {}
Local aHelpEng := {}


//Do Fretista
aHelpPor := {}
Aadd( aHelpPor, 'Codigo do Setor        ')
U_xPutSx1(cPerg,"01","Setor   "," "," ","mv_ch1","C",6,0,0,"G",'U_ValSetPar()',"ZL2_01","","","MV_PAR01","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)

//Da Linha
aHelpPor := {}
Aadd( aHelpPor, 'Informe o codigo inicial da linha   ')
Aadd( aHelpPor, 'que deseja filtrar.                 ')
U_xPutSx1(cPerg,"02","Da Linha"," "," ","mv_ch2","C",6,0,0,"G","","ZLW_01","","","MV_PAR02","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)

//Da Linha
aHelpPor := {}
Aadd( aHelpPor, 'Informe o codigo final da linha   ')
Aadd( aHelpPor, 'que deseja filtrar.                 ')
U_xPutSx1(cPerg,"03","Ate Linha"," "," ","mv_ch3","C",6,0,0,"G","","ZLW_01","","","MV_PAR03","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)

//Do Periodo
aHelpPor := {}
Aadd( aHelpPor, 'Periodo do relatorio')
U_xPutSx1(cPerg,"04","Data Inicial"," "," ","mv_ch4","D",8,0,0,"G","","","","","MV_PAR04","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)

//Do Periodo
aHelpPor := {}
Aadd( aHelpPor, 'Periodo do relatorio')
U_xPutSx1(cPerg,"05","Data Final"," "," ","mv_ch5","D",8,0,0,"G","","","","","MV_PAR05","","","","","","","","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)

//Mostrar Custo
aHelpPor := {}
Aadd( aHelpPor, '')
U_xPutSx1(cPerg,"06","Mostra custo?(S/N)"," "," ","mv_ch6","N",1,0,0,"C","","","","","MV_PAR06","Sim","Sim","Sim","","Nao","Nao","Nao","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)

Return

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบPrograma  ณRGLT021   บAutor  ณMicrosiga           บ Data ณ  09/09/10   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณ                                                            บฑฑ
ฑฑบ          ณ                                                            บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ                                                            บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
*/
Static Function SubTotal(nLin,dt1,dt2)

Local nKmRodado:=0
Local nVlrPago:=0

// km rodado na linha (independente do fretista)
nkmRodado:=u_getkm(xFILIAL("ZLD"),MV_PAR01,cUltLin,,,dt1,dt2)

// valor total pago de frete
nVlrPago:=nKmRodado*nTarifa

@nLin,000 PSAY __PrtThinLine()
nLin++

@nLin,000 PSAY "Produtores:"+alltrim(str(nQtdPrd))
@nLin,028 PSAY TransForm(nVol,"@E 999,999,999")
@nLin,040 PSAY TransForm((nVol/nQtdDias),"@E 9,999,999")
//@nLin,060 PSAY "Km Rodado:"+TransForm(nKmRodado,"@E 9,999,999")
If MV_PAR06 == 1
	@nLin,080 PSAY "Densidade:"+TransForm(nVol/nKmRodado,"@E 9,999,999")
	@nLin,100 PSAY "Custo do Frete"+TransForm(nVlrPago/nVol,"@E 99,999.9999")
EndIf
nLin++

@nLin,000 PSAY __PrtThinLine()
nLin++

nQtdPrd:=0
nVol:=0

Return nLin


/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบPrograma  ณRGLT021   บAutor  ณMicrosiga           บ Data ณ  09/09/10   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณ                                                            บฑฑ
ฑฑบ          ณ                                                            บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ AP                                                        บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
*/
Static Function showCabec(nLin)

nTarifa:=0

dbSelectArea("ZLW")
dbSetOrder(1)
dbSeek(xFILIAL("ZLW")+TRF->ZLD_LINROT)

@nLin,000 PSAY "Linha/Rota:"+TRF->ZLD_LINROT
@nLin,020 PSAY left( ZLW->ZLW_DESCRI , 19 )
@nLin,040 PSAY "Km:"+alltrim(str(ZLW->ZLW_KM))
@nLin,060 PSAY "Tarifa:"+alltrim(str(ZLW->ZLW_VLRFRT))
If ZLW->ZLW_FRMPG == "L"
	@nLin,080 PSAY "Forma Pagto: Por Litro"
ElseIf ZLW->ZLW_FRMPG == "K"
	@nLin,080 PSAY "Forma Pagto: Por Km"
	nTarifa:=ZLW->ZLW_VLRFRT
ElseIf ZLW->ZLW_FRMPG == "F"
	@nLin,080 PSAY "Forma Pagto: Mensal"
ElseIf ZLW->ZLW_FRMPG == "V"
	@nLin,080 PSAY "Forma Pagto: Viagem"
EndIf
nLin++


@nLin,000 PSAY "Transportador:"+ZLW->ZLW_FRETIS+" "+ZLW->ZLW_FRETLJ+" "+POSICIONE("SA2",1,xFILIAL("SA2")+ZLW->ZLW_FRETIS+ZLW->ZLW_FRETLJ,"A2_NOME")
nLin++

@nLin,000 PSAY __PrtThinLine()
nLin++

Return nLin